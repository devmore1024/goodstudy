# F2 家庭成员管理

## 页面信息
- **所属模块**：F 系列 - 账户与设置
- **页面类型**：全屏页
- **数字人老师**：不显示
- **支持模式**：家长（学生模式下可查看但不可编辑/删除）

## 线框图

### 主界面

```
┌──────────────────────────────────┐
│ 状态栏                       ▐██ │
├──────────────────────────────────┤
│  ←  家庭成员管理                 │
├──────────────────────────────────┤
│                                  │
│  家庭账户：138****1234           │
│  共 4 位成员                     │
│                                  │
│  ── 家长 ──────────────────────  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ ┌────┐                    │  │
│  │ │头像│ 张爸爸              │  │
│  │ └────┘ 家长（管理员）      │  │
│  │        声纹：已录入 ✓      │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ ┌────┐                    │  │
│  │ │头像│ 张妈妈              │  │
│  │ └────┘ 家长                │  │
│  │        声纹：已录入 ✓      │  │
│  └────────────────────────────┘  │
│                                  │
│  ── 学生 ──────────────────────  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ ┌────┐                    │  │
│  │ │头像│ 张小明              │  │
│  │ └────┘ 学生 · 三年级       │  │
│  │        声纹：已录入 ✓      │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ ┌────┐                    │  │
│  │ │头像│ 张小红              │  │
│  │ └────┘ 学生 · 一年级       │  │
│  │        声纹：未录入 ⚠      │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │      ＋ 添加家庭成员        │  │
│  └────────────────────────────┘  │
│                                  │
└──────────────────────────────────┘
```

### 左滑删除状态

```
┌──────────────────────────────────┐
│  ┌──────────────────────┬─────┐  │
│  │ ┌────┐               │     │  │
│  │ │头像│ 张小红         │ 删除│  │
│  │ └────┘ 学生 · 一年级  │     │  │
│  │        声纹：未录入 ⚠ │     │  │
│  └──────────────────────┴─────┘  │
└──────────────────────────────────┘
```

### 删除确认弹窗

```
┌──────────────────────────────────┐
│                                  │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │   确认删除成员"张小红"？    │  │
│  │                            │  │
│  │  删除后该成员的学习记录     │  │
│  │  将被保留30天，之后永久     │  │
│  │  删除，且声纹信息将同步     │  │
│  │  清除。                    │  │
│  │                            │  │
│  │  ┌──────┐  ┌──────────┐   │  │
│  │  │ 取消 │  │  确认删除 │   │  │
│  │  └──────┘  └──────────┘   │  │
│  └────────────────────────────┘  │
│                                  │
└──────────────────────────────────┘
```

### 成员详情底部弹层（点击成员卡片）

```
┌──────────────────────────────────┐
│          （页面内容变暗）          │
│                                  │
│  ┌────────────────────────────┐  │
│  │  ┌──────┐                  │  │
│  │  │ 头像 │  张小明           │  │
│  │  │ 64pt │  学生 · 三年级    │  │
│  │  └──────┘                  │  │
│  │                            │  │
│  │  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  │  │
│  │  昵称      张小明      编辑 │  │
│  │  角色      学生             │  │
│  │  年级      三年级       编辑 │  │
│  │  声纹状态  已录入 ✓         │  │
│  │                            │  │
│  │  ┌────────────────────┐    │  │
│  │  │    管理声纹  →      │    │  │
│  │  └────────────────────┘    │  │
│  └────────────────────────────┘  │
└──────────────────────────────────┘
```

## 元素说明

| 序号 | 元素名称 | 类型 | 说明 |
|------|---------|------|------|
| 1 | 导航栏 | 顶部导航 | 左侧返回箭头 + 标题"家庭成员管理"，高度 44pt |
| 2 | 家庭信息摘要 | 文本区域 | 显示脱敏手机号和成员总数，14pt 灰色文字 |
| 3 | 分组标题 | 文本 | "家长"/"学生"分组标签，12pt 灰色，带水平分割线 |
| 4 | 成员卡片 | 卡片容器 | 白色圆角卡片，内边距 16pt，包含头像、姓名、角色信息、声纹状态 |
| 5 | 成员头像 | 圆形图片 | 48x48pt，家长默认蓝色底，学生默认橙色底 |
| 6 | 成员姓名 | 文本 | 16pt 加粗黑色 |
| 7 | 角色标签 | 文本 | 14pt 灰色，家长显示"家长"或"家长（管理员）"，学生显示"学生 · X年级" |
| 8 | 声纹状态 | 状态标签 | 已录入显示绿色勾，未录入显示橙色警告图标 |
| 9 | 删除按钮 | 滑动操作 | 红色背景白色文字，宽度 80pt，左滑卡片后露出 |
| 10 | 添加成员按钮 | 虚线卡片按钮 | 虚线边框，内含"+"号和文字，高度 56pt，居中显示 |
| 11 | 成员详情弹层 | 底部弹层 | 从底部滑出，圆角顶部，展示成员详细信息和操作入口 |
| 12 | 管理声纹按钮 | 主操作按钮 | 弹层内，跳转至 F3 声纹管理，携带当前成员信息 |

## 交互行为

### 手势交互
- **左滑删除**：在成员卡片上向左滑动（滑动距离 > 80pt 时触发），露出红色「删除」按钮；管理员卡片不可左滑删除
- **点击卡片**：点击成员卡片弹出底部详情弹层
- **下拉操作**：弹层区域下拉可关闭弹层
- **返回手势**：从屏幕左边缘右滑返回 F1

### 输入交互
- **添加成员**：点击「添加家庭成员」按钮 → 跳转至 A3 新成员引导页，由 AI 老师通过对话引导完成新成员创建（采集姓名、角色、年级等信息）
- **删除成员**：左滑露出删除按钮 → 点击「删除」→ 弹出确认弹窗 → 确认后执行删除
- **编辑信息**：在详情弹层中点击「编辑」可修改昵称和年级
- **管理声纹**：弹层内点击「管理声纹」跳转 F3，并自动选中该成员

### 动画与反馈
- **卡片左滑**：跟手滑动动画，松手后自动回弹或展开到位（带弹性动画 300ms）
- **删除动画**：确认删除后，卡片向左滑出屏幕（250ms），下方卡片上移填充空位（200ms）
- **添加反馈**：新成员创建成功返回本页时，新卡片从底部渐入（300ms），列表自动滚动到新增卡片位置
- **弹层动画**：底部弹层滑入（300ms ease-out），背景遮罩渐现（200ms）
- **页面切换**：进入/离开页面使用标准 push/pop 右滑推入动画

### AI 老师交互
- 本页面不直接显示 AI 老师
- 添加成员时跳转 A3 页面，由 AI 老师引导完成新成员的信息采集和声纹录入

## 状态枚举

### 默认状态
- 成员列表正常展示，按家长/学生分组排列
- 每张卡片显示完整信息：头像、姓名、角色、声纹状态
- 底部显示「添加家庭成员」按钮

### 空状态
- 理论上不存在完全空状态（至少有一个管理员账户）
- 若某分组为空（如无学生成员），该分组标题仍显示，下方显示引导文案："还没有学生成员，添加后可使用学习功能"

### 加载状态
- 进入页面时显示骨架屏：卡片形状的灰色占位块 + 脉冲闪烁动画
- 骨架屏数量为 3 个卡片占位（通用数量）
- 加载时间超过 5 秒显示"加载中..."文字提示

### 错误状态
- 网络异常：页面显示已缓存的成员列表（离线优先策略）
- 无缓存时：显示空状态插画 + "网络连接异常，请检查后重试" + 「重试」按钮
- 删除失败：toast 提示"删除失败，请重试"，卡片自动回弹到原位
- 添加成员返回但创建失败：toast 提示"成员创建未完成"

### 边界情况
- **成员上限**：家庭成员最多支持 8 人（2 家长 + 6 学生），达到上限后「添加家庭成员」按钮置灰，文字改为"已达成员上限（8人）"
- **仅剩管理员**：当只剩管理员一人时，该卡片不可左滑，无删除操作
- **学生模式限制**：学生模式下可查看成员列表，但不显示左滑删除、不显示添加按钮、详情弹层中不显示编辑按钮
- **长姓名**：姓名超过 6 个字时截断 + 省略号，详情弹层中完整显示
- **同名成员**：允许同名，通过头像和角色信息区分

## 导航关系

### 从哪来
| 来源页面 | 触发方式 | 转场动画 |
|---------|---------|---------|
| F1 个人中心 | 点击「家庭成员管理」菜单项 | 右滑推入（push） |

### 到哪去
| 目标页面 | 触发方式 | 转场动画 |
|---------|---------|---------|
| F1 个人中心 | 左上角返回 / 左边缘右滑 | 左滑退出（pop） |
| A3 新成员引导 | 点击「添加家庭成员」 | 右滑推入（push） |
| F3 声纹管理 | 详情弹层点击「管理声纹」 | 右滑推入（push），携带成员 ID |
