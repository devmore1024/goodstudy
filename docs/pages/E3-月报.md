# E3 月报

## 页面信息
- **所属模块**：E 学习报告模块
- **页面类型**：Tab页（底部第三个Tab：学习报告，子Tab"月报"）
- **数字人老师**：小/右上角悬浮
- **支持模式**：通用（学生模式与家长模式均可查看，家长模式额外显示排名趋势与综合评估）

## 线框图

```
┌──────────────────────────────────┐
│ 9:41              ⚡ LTE  🔋82% │
├──────────────────────────────────┤
│  学习报告                    👤  │
├──────────────────────────────────┤
│   每日    周报   [月报]          │
│                  ─────           │
├──────────────────────────────────┤
│   ◀    2026年2月    ▶           │
├──────────────────────────────────┤
│  排名百分位趋势                  │
│  %                               │
│ 100│                             │
│  90│              ·──·──·       │
│  80│         ·──·╱              │
│  70│    ·──·╱                   │
│  60│   ╱                        │
│  50│  ·                         │
│    └──┬──┬──┬──┬──┬──┬──┬──┬── │
│      9月10 11 12 1月 2月        │
│             (近6个月)            │
├──────────────────────────────────┤
│  月度数据                 ← ⬤ → │
│ ┌──────────┬──────────┬────────┐│
│ │ 学习时长  │ 平均正确率│ 答题量 ││
│ │          │          │        ││
│ │ 22h 30m  │  84%     │ 742题  ││
│ │          │          │        ││
│ │ 上月     │ 上月     │ 上月   ││
│ │ 20h 10m  │ 80%      │ 680题  ││
│ │ ▲ +12%  │ ▲ +4%   │ ▲ +9% ││
│ └──────────┴──────────┴────────┘│
│       ⬤        ○        ○      │
├──────────────────────────────────┤
│  知识掌握全景                    │
│ ┌────────────────────────────┐  │
│ │  数学                  [展开]│  │
│ │  ██████████████░░░░  75%   │  │
│ │  ┌─────────────────────┐   │  │
│ │  │ ✅ 一次函数      92% │   │  │
│ │  │ ✅ 几何证明      88% │   │  │
│ │  │ ⚠ 二次函数      45% │   │  │
│ │  │ ⚠ 概率统计      52% │   │  │
│ │  └─────────────────────┘   │  │
│ ├────────────────────────────┤  │
│ │  语文                  [展开]│  │
│ │  ████████████████░░░  82%  │  │
│ ├────────────────────────────┤  │
│ │  英语                  [展开]│  │
│ │  ██████████████████░  90%  │  │
│ ├────────────────────────────┤  │
│ │  物理                  [展开]│  │
│ │  ██████████░░░░░░░░░  55%  │  │
│ └────────────────────────────┘  │
├──────────────────────────────────┤
│  ┌────────────────────────────┐  │
│  │ 🤖 小花老师月度评估        │  │
│  │                            │  │
│  │ "2月份的学习表现整体优秀！ │  │
│  │  排名百分位从70%提升到     │  │
│  │  90%，进步非常明显。       │  │
│  │                            │  │
│  │  亮点：                    │  │
│  │  · 英语阅读理解突飞猛进    │  │
│  │  · 每天坚持学习，无缺席    │  │
│  │                            │  │
│  │  待改进：                  │  │
│  │  · 物理力学模块需重点关注  │  │
│  │  · 数学概率统计偏弱..."    │  │
│  │                            │  │
│  │         [展开全部 ▼]       │  │
│  └────────────────────────────┘  │
├──────────────────────────────────┤
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │     📋 调整学习计划         │  │
│  │                            │  │
│  └────────────────────────────┘  │
│                                  │
│                          ┌─────┐│
│                          │ 🧑‍🏫 ││
│                          │小花 ││
│                          └─────┘│
├──────────────────────────────────┤
│  🏠首页   📚学习   📊报告  👤我│
└──────────────────────────────────┘
```

## 元素说明

### 顶部导航栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 页面标题 | 文本 | "学习报告"，固定显示 |
| 用户头像 | 图标按钮 | 右上角，点击进入个人中心 |

### 子Tab栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 每日 | Tab项 | 切换至E1每日报告页 |
| 周报 | Tab项 | 切换至E2周报页 |
| 月报 | Tab项 | 当前选中，底部带高亮下划线指示器 |

### 月份选择器
| 元素 | 类型 | 说明 |
|------|------|------|
| 左箭头 | 图标按钮 | 切换至前一个月 |
| 右箭头 | 图标按钮 | 当前月时置灰不可点 |
| 月份标题 | 文本 | 格式"YYYY年M月"，点击可弹出月份选择器快速跳转 |

### 排名百分位趋势折线图
| 元素 | 类型 | 说明 |
|------|------|------|
| 折线图 | 图表组件 | X轴为近6个月月份，Y轴为排名百分位（0%-100%） |
| 折线 | 渐变色实线 | 从浅蓝渐变至深蓝，线条宽度2dp |
| 数据节点 | 实心圆点 | 每月一个节点，当前月节点放大并带脉冲动效 |
| 节点标签 | 浮层文本 | 点击节点显示"第XX名 / 共XX人 · 超越XX%同学" |
| 填充区域 | 渐变填充 | 折线下方至X轴的区域填充半透明渐变蓝色 |
| 目标线 | 虚线 | 如设有排名目标，显示红色虚线水平参考线 |

### 月度数据卡片（水平滚动）
| 元素 | 类型 | 说明 |
|------|------|------|
| 卡片容器 | 水平滑动容器 | 包含3张数据卡片，支持左右滑动切换 |
| 学习时长卡片 | 数据卡片 | 显示本月总学习时长、上月数据、环比变化 |
| 平均正确率卡片 | 数据卡片 | 显示本月平均正确率、上月数据、环比变化 |
| 答题量卡片 | 数据卡片 | 显示本月总答题量、上月数据、环比变化 |
| 分页指示器 | 圆点指示器 | 卡片下方，实心圆点表示当前卡片，空心圆点表示其他卡片 |
| 增长标记 | 图标+文本 | 绿色▲箭头 + 增长百分比 |
| 下降标记 | 图标+文本 | 红色▼箭头 + 下降百分比 |

### 知识掌握全景
| 元素 | 类型 | 说明 |
|------|------|------|
| 学科行 | 可展开列表项 | 每个学科一行，显示学科名称、总掌握进度条、掌握百分比 |
| 掌握进度条 | 进度条 | 填充色根据掌握度变化：>=80%绿色，60%-79%橙色，<60%红色 |
| 展开/收起按钮 | 文字按钮 | "[展开]"/"[收起]"，控制学科下属知识点的显示 |
| 知识点列表 | 子列表 | 展开后显示该学科下所有知识点，每项包含名称、掌握度、状态图标 |
| 知识点状态图标 | 图标 | 掌握>=80%显示绿色✅，60%-79%显示黄色⚡，<60%显示橙色⚠ |
| 知识点名称 | 可点击文本 | 点击跳转至D4知识点详情页 |
| 知识点掌握度 | 百分比文本 | 显示具体掌握百分比 |

### AI老师月度评估卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 卡片容器 | 圆角卡片 | 浅紫色渐变背景，带金色边框装饰（月报特殊样式） |
| 评估标题 | 文本 | "小花老师月度评估" |
| 评估内容 | 富文本 | 包含整体表现评价、进步亮点列表、待改进列表、下月建议，默认显示前6行 |
| 展开按钮 | 可点击文本 | "展开全部 ▼"/"收起 ▲" |

### 调整学习计划按钮
| 元素 | 类型 | 说明 |
|------|------|------|
| CTA按钮 | 主操作按钮 | 蓝色填充圆角矩形，文案"调整学习计划"，带书单图标前缀 |
| 按钮位置 | 底部固定区域 | 在AI评估卡片下方，距底部Tab栏有间距 |

### 悬浮数字人老师
| 元素 | 类型 | 说明 |
|------|------|------|
| 小花老师头像 | 悬浮按钮 | 右下角悬浮，尺寸48x48dp，可拖动 |

## 交互行为

### 手势交互
| 手势 | 作用区域 | 行为 |
|------|----------|------|
| 左右滑动 | 月份选择器区域 | 切换前一月/后一月的月报 |
| 左右滑动 | 子Tab栏下方整体内容区 | 切换每日/周报/月报子Tab |
| 左右滑动 | 月度数据卡片区域 | 在学习时长/正确率/答题量三张卡片间切换 |
| 上下滑动 | 页面主内容区 | 滚动浏览月报内容 |
| 点击折线节点 | 排名百分位趋势图 | 弹出详细排名信息浮层 |
| 点击学科行 | 知识掌握全景 | 展开/收起该学科下属知识点列表 |
| 点击知识点名称 | 知识掌握全景子列表 | 跳转至D4知识点详情页 |
| 点击CTA按钮 | 调整学习计划按钮 | 跳转至C1学习计划页 |
| 拖拽 | 小花老师悬浮头像 | 可在屏幕右侧边缘上下拖动调整位置 |

### 输入交互
| 输入方式 | 说明 |
|----------|------|
| 月份点击 | 点击月份标题文本弹出月份滚轮选择器，可快速跳转至指定月份 |
| 长按知识点 | 长按知识掌握全景中的知识点弹出快捷菜单"查看详情/去练习/添加到计划" |

### 动画与反馈
| 动画 | 触发条件 | 效果说明 |
|------|----------|----------|
| 排名趋势线绘制 | 页面加载完成 | 折线从最早月份到当前月份逐段绘制，时长800ms，带贝塞尔曲线缓动 |
| 当前月节点脉冲 | 折线绘制完成 | 当前月节点圆点持续脉冲放大缩小动效，循环播放 |
| 排名上升粒子效果 | 排名较上月提升时 | 折线末端（当前月节点）释放向上飘散的星星粒子效果，时长1200ms |
| 数据卡片滑动 | 左右滑动月度数据卡片 | 卡片间平滑切换，带缩放效果（当前卡片100%，相邻卡片90%），分页指示器同步更新 |
| 数据递增动画 | 数据卡片进入视口 | 数字从0递增到实际值，时长500ms |
| 进度条填充 | 知识掌握全景加载完成 | 所有学科进度条同时从0%填充至实际百分比，时长400ms |
| 学科展开动画 | 点击学科展开按钮 | 子列表从高度0展开，每个知识点依次延迟50ms出现，带向右滑入效果 |
| CTA按钮呼吸 | 页面滚动至按钮可见 | 按钮轻微缩放呼吸效果吸引注意力，幅度2%，周期2s |
| 月份切换过渡 | 左右滑动切换月份 | 内容区整体随滑动方向平移+淡入淡出过渡，时长250ms |

### AI老师交互
| 场景 | 交互行为 |
|------|----------|
| 月报首次查看 | 小花老师浮现气泡"月度报告出炉啦！来看看这个月的成长吧" |
| 点击悬浮头像 | 展开对话浮层，小花老师给出月度综合分析与下月规划建议 |
| 排名百分位显著提升（>10%） | 小花老师播放庆祝动效（撒花+鼓掌），气泡"排名大幅提升，你太厉害了！" |
| 排名百分位下降 | 小花老师显示鼓励气泡"这个月有些波动，没关系，我们一起调整计划" |
| 某学科掌握度<50% | 小花老师针对性提醒"XX学科需要重点关注哦，要不要一起制定专项计划？" |
| 全部学科掌握度>80% | 小花老师特别表扬"所有学科都掌握得很好，继续保持这个状态！" |
| 家长模式 | 小花老师提供详细的月度学习分析报告，包含学习习惯评估、薄弱环节分析、家庭辅导建议、下月学习规划推荐 |
| 点击"调整学习计划"按钮前 | 小花老师弹出确认气泡"我根据本月数据为你准备了计划调整建议，一起看看？" |

## 状态枚举

### 默认状态
- 显示当前月（本月）的完整月报
- 右箭头置灰不可点（不可查看未来月份）
- 排名趋势图显示近6个月数据
- 月度数据卡片默认显示第一张（学习时长），左右可滑动
- 知识掌握全景默认全部学科收起（仅显示学科行与进度条）
- AI月度评估默认折叠显示前6行
- "调整学习计划"CTA按钮常驻显示

### 空状态
- **本月无任何学习记录**
  - 排名趋势图当前月无节点，显示虚线占位
  - 月度数据卡片显示"0h 0min / -- / 0题"
  - 知识掌握全景显示"本月暂无学习数据"
  - AI评估替换为鼓励文案"新的一月，让我们一起定个学习目标吧！"
  - CTA按钮文案变更为"制定学习计划"
  - 显示辅助入口"去学习"跳转至B1

### 加载状态
- 月份选择器正常显示
- 排名趋势图区域显示波浪线骨架屏
- 月度数据卡片显示矩形骨架屏
- 知识掌握全景显示4-5行条形骨架屏
- AI评估卡片显示矩形骨架屏
- 加载时长超过5秒显示"报告生成中..."文案

### 错误状态
- **网络异常**：页面中部显示断网插画 + "网络开小差了" + "重新加载"按钮
- **服务端错误**：页面中部显示错误插画 + "月报生成失败" + "重新加载"按钮
- **部分数据缺失**：已有数据正常展示，缺失模块显示"数据暂不可用，请稍后查看"

### 边界情况
| 场景 | 处理方式 |
|------|----------|
| 注册不满一个月 | 排名趋势图仅显示已有月份数据，不足6个月时X轴自动适配 |
| 注册不满一周 | 月度数据可能不完整，底部显示提示"数据统计中，月底将生成完整报告" |
| 上月无数据（无法对比） | 数据卡片中上月行显示"暂无数据"，环比变化不显示 |
| 学科数量超过8个 | 知识掌握全景可滚动显示，前6个默认展示，超出部分需滚动查看 |
| 某学科本月仅做了1-2题 | 该学科掌握度标注"样本量过少"灰色标签，百分比仅供参考 |
| 知识点数量超过20个 | 展开学科后默认显示Top10知识点，底部提供"查看全部XX个知识点"按钮 |
| 月报尚在生成中（月初1-2号） | 显示"上月报告正在生成中，请稍后查看"，展示已有的部分数据 |
| 排名百分位首次显示（仅1个月数据） | 折线图仅显示一个点，不画连线，提示"持续学习，下月将展示趋势" |
| 家长模式 vs 学生模式 | 家长模式在排名趋势图中额外显示"年级平均线"，在月度数据卡片中增加"班级排名"子项 |
| 正确率连续3个月上升 | 数据卡片中正确率显示金色特效边框 + "三连涨"徽章 |

## 导航关系

### 从哪来
| 来源页面 | 触发方式 | 传入参数 |
|----------|----------|----------|
| E1 每日报告 | 点击子Tab"月报" | month_of（当前查看日期所在月） |
| E2 周报 | 点击子Tab"月报" | month_of（当前查看周所在月） |
| B1 首页 | 点击底部Tab"学习报告"后切换子Tab | 无（默认当前月） |
| B2 学习主页 | 点击"查看月度报告"入口 | month_of（指定月份） |
| 推送通知 | 点击"月度学习报告已生成"推送 | month_of（指定月份） |

### 到哪去
| 目标页面 | 触发方式 | 传出参数 |
|----------|----------|----------|
| E1 每日报告 | 点击子Tab"每日" | 无（恢复上次查看日期） |
| E2 周报 | 点击子Tab"周报" | 无（默认当前周） |
| C1 学习计划 | 点击"调整学习计划"CTA按钮 | month_data_summary（本月数据摘要，用于智能推荐计划） |
| D4 知识点详情 | 点击知识掌握全景中的知识点名称 | knowledge_point_id |
| D5 知识点练习 | 长按知识点后选择"去练习" | knowledge_point_id, source="monthly_report" |
| 对话浮层 | 点击悬浮小花老师头像 | context="monthly_report", month_of |
