# A2 手机号登录

## 页面信息
- **所属模块**：登录注册模块
- **页面类型**：全屏页
- **数字人老师**：小/右上角悬浮
- **支持模式**：通用

## 线框图

```
+----------------------------------------+
|  9:41            ⚡ 📶 100%            |
|                                        |
|                                        |
|                                        |
|           +------------+               |
|           |   小花老师   |               |
|           |  真实头像    |               |
|           |  96x96 圆形  |               |
|           +------------+               |
|             小花老师                     |
|                                        |
|         欢迎来到小花老师                |
|       登录后开启你的AI伴学之旅          |
|                                        |
|                                        |
|    +86 | 请输入手机号              ✓   |
|    ──────────────────────────────────   |
|                                        |
|    请输入验证码          获取验证码      |
|    ──────────────────────────────────   |
|                                        |
|                                        |
|    +----------------------------------+|
|    |          登   录                 ||
|    +----------------------------------+|
|                                        |
|    ☐ 我已阅读并同意《用户协议》和       |
|      《隐私政策》                       |
|                                        |
|          小花老师 · 让学习更高效        |
|                                        |
+----------------------------------------+
```

## 元素说明

### 1. 导航栏
- **位置**：状态栏下方
- **样式**：透明背景，无标题
- **左侧**：无返回按钮（登录页为流程起点）
- **说明**：从 A1 跳转来时无需返回

### 2. 数字人老师头像
- **位置**：页面垂直居中区域顶部，水平居中
- **尺寸**：96 × 96 pt 圆形（upper 模式）
- **内容**：小花老师真实卡通头像图片（`/images/teacher.png`）
- **样式**：圆形裁剪，白色描边 ring-3、阴影 shadow-xl、半透明品牌色渐变光晕
- **动画**：淡入动画
- **说明**：头像下方显示"小花老师"文字标签

### 3. 欢迎标题
- **位置**：头像下方 24pt，水平居中
- **内容**：「欢迎来到小花老师」
- **样式**：字号 26pt，字重 Bold，颜色 #1F2937，居中对齐

### 4. 欢迎副标题
- **位置**：标题下方 8pt，水平居中
- **内容**：「登录后开启你的AI伴学之旅」
- **样式**：字号 14pt，字重 Regular，颜色 #9CA3AF，居中对齐

### 5. 页面布局
- **整体布局**：内容区域垂直居中（flex justify-center），不再顶部对齐
- **背景**：温暖渐变背景 page-bg-warm（#FFF8F2→#FFF1E8→#FFFFFF→#F0FAF4）
- **装饰元素**：半透明渐变装饰圆形（右上角橙色/5 大圆、左下角品牌绿/5 中圆）
- **内容间距**：头像到标题 24pt、副标题到手机号 40pt、手机号到验证码 24pt、验证码到登录按钮 40pt

### 6. 手机号输入框
- **位置**：副标题下方 40pt，左右边距 32pt
- **标签**：「手机号」，字号 14pt，颜色 #666666，距输入框上方 8pt
- **输入框高度**：48pt
- **内容结构**：
  - 左侧区号选择器：「+86 ▼」，宽 72pt，点击展开区号选择列表
  - 分隔线：1px 竖线，颜色 #E5E5E5，高 24pt
  - 右侧输入区：placeholder「请输入手机号」，颜色 #CCCCCC
- **样式**：圆角 8pt，边框 1px #E5E5E5，聚焦时边框变为品牌色 #FF7A45
- **键盘**：数字键盘（UIKeyboardTypePhonePad）
- **格式化**：自动按 3-4-4 格式添加空格（如 138 0000 0000）

### 7. 验证码输入框
- **位置**：手机号输入框下方 24pt
- **标签**：「验证码」，字号 14pt，颜色 #666666
- **输入框结构**：
  - 左侧输入区：占据剩余空间，placeholder「请输入验证码」
  - 右侧发送按钮：与输入框同行
- **输入框样式**：同手机号输入框

### 8a. 获取验证码按钮
- **位置**：验证码输入框右侧，内嵌
- **尺寸**：宽 88pt，高 48pt
- **默认文字**：「获取验证码」，字号 14pt，品牌色 #FF7A45
- **倒计时文字**：「59s 后重发」，字号 14pt，颜色 #CCCCCC
- **样式**：无边框，背景透明
- **交互**：
  - 手机号未填满 11 位时：按钮置灰不可点
  - 手机号填满后：按钮激活可点
  - 点击后：60 秒倒计时，期间按钮不可点击且显示倒计时文字
  - 倒计时结束：恢复「重新获取」可点击状态

### 8. 登录按钮
- **位置**：验证码输入框下方 40pt，左右边距 32pt
- **尺寸**：宽度充满，高 52pt（py-4）
- **文字**：「登录」，字号 16pt，字重 Semibold，白色
- **样式**：
  - 默认禁用态：背景 #E5E7EB（灰色），文字 #9CA3AF，无阴影，圆角 16pt
  - 可点击态：背景渐变 #FF7A45 → #FF5722，圆角 16pt，橙色发光阴影 btn-glow-orange
- **激活条件**：手机号 11 位 + 验证码 4/6 位 + 协议已勾选
- **点击反馈**：按下缩放至 0.97，松手恢复

### 9. 用户协议勾选区域（居中显示）
- **位置**：页面底部安全区域上方 24pt，左右边距 24pt
- **结构**：
  - 勾选框：18 × 18 pt，未勾选时为空心圆角方框，勾选时填充品牌色 + 白色对勾
  - 文字：「我已阅读并同意」+ 可点击链接「《用户协议》」+「和」+ 可点击链接「《隐私政策》」
- **文字样式**：字号 12pt，普通文字颜色 #999999，链接文字颜色 #FF7A45
- **交互**：
  - 点击勾选框或文字均可切换勾选状态
  - 点击链接文字跳转对应协议页面（应用内 WebView）
  - 未勾选时点击登录按钮：弹出底部提示「请先阅读并同意用户协议和隐私政策」

## 交互行为

### 手势交互
- **下滑收起键盘**：在非输入区域下滑或点击空白处收起键盘
- **侧滑返回**：禁用（登录页为流程入口）
- **点击数字人头像**：播放语音鼓励

### 输入交互
- **手机号输入**：
  - 仅允许输入数字，自动过滤其他字符
  - 自动格式化为 3-4-4（显示用，提交时去掉空格）
  - 输入满 11 位后自动跳转焦点到验证码输入框
  - 清空按钮：输入框有内容时右侧显示灰色圆形清除按钮
- **验证码输入**：
  - 仅允许输入数字，4 或 6 位（根据后端返回）
  - 支持短信验证码自动填充（iOS AutoFill / Android SMS Retriever）
  - 输入满位数后自动触发登录（若协议已勾选）
- **键盘适配**：
  - 键盘弹起时，页面整体上移，确保当前聚焦输入框在可视区域内
  - 上移采用平滑动画，时长 250ms
  - 键盘收起时页面平滑回落

### 动画与反馈
- **页面进入**：从右侧滑入（标准 push 动画），时长 300ms
- **输入框聚焦**：边框颜色从 #E5E5E5 渐变为 #FF7A45，时长 200ms
- **登录按钮激活**：从禁用态到激活态，背景色渐变过渡，时长 300ms
- **登录中**：按钮文字替换为加载动画（旋转白色圆环），按钮不可再次点击
- **登录成功**：按钮变为绿色 + 对勾动画，400ms 后跳转
- **验证码发送成功**：轻微震动反馈（Haptic feedback，light）

### AI 老师交互
- **页面加载时**：数字人老师头像出现，播放欢迎语「你好呀，我是小花老师，快来登录吧~」（首次进入时播放，非首次不播放）
- **输入手机号时**：无交互
- **获取验证码后**：小花老师语音提示「验证码已发送到你的手机，注意查收哦~」
- **登录失败时**：小花老师语音安慰「别着急，再试一次吧~」

## 状态枚举

### 默认状态
- 手机号输入框为空，自动获取焦点，数字键盘弹起
- 验证码输入框为空，获取验证码按钮置灰
- 登录按钮置灰不可点
- 协议勾选框未勾选

### 空状态
- 不适用（登录页为表单页，无列表数据）

### 加载状态
- **发送验证码中**：获取验证码按钮显示小型加载动画，不可再次点击
- **登录中**：登录按钮显示加载动画，所有输入框和按钮不可交互
- **页面加载**：页面本身无加载状态，所有元素立即渲染

### 错误状态
- **手机号格式错误**：输入框下方显示红色提示文字「请输入正确的手机号」，边框变红 #FF4D4F
- **验证码错误**：输入框下方显示红色提示文字「验证码错误，请重新输入」，验证码输入框自动清空并获取焦点
- **验证码发送频率限制**：Toast 提示「请求太频繁，请稍后再试」
- **验证码发送失败**：Toast 提示「验证码发送失败，请检查手机号」
- **网络错误**：Toast 提示「网络连接异常，请检查网络设置」
- **服务端错误**：Toast 提示「服务暂时不可用，请稍后重试」
- **账号异常（封禁等）**：弹窗提示异常原因及客服联系方式

### 边界情况
- **多次发送验证码**：每次倒计时独立，不受页面切换影响（后台计时）
- **粘贴长文本**：自动截取前 11 位数字（手机号）/ 前 6 位数字（验证码）
- **区号切换**：切换区号后清空手机号输入，手机号长度规则随区号变化
- **横竖屏**：强制竖屏
- **无 SIM 卡**：正常显示页面，可正常输入手机号（用户可能在其他设备接收短信）
- **辅助功能**：所有输入框和按钮支持 VoiceOver/TalkBack 语义标注

## 导航关系

### 从哪来
- A1 启动页（首次用户或令牌失效）
- 设置页（主动退出登录后）

### 到哪去
- **首次注册用户** → A3 AI老师欢迎对话页
- **已有档案的回归用户（学生）** → B1 学生首页
- **已有档案的回归用户（家长）** → B2 家长首页
- **点击用户协议链接** → 用户协议 WebView 页（模态弹出）
- **点击隐私政策链接** → 隐私政策 WebView 页（模态弹出）
