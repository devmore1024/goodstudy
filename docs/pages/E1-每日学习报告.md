# E1 每日学习报告

## 页面信息
- **所属模块**：E 学习报告模块
- **页面类型**：Tab页（底部第三个Tab：学习报告，默认子Tab为"每日"）
- **数字人老师**：小/右上角悬浮
- **支持模式**：通用（学生模式与家长模式均可查看，家长模式额外显示对比数据）

## 线框图

```
┌──────────────────────────────────┐
│ 9:41              ⚡ LTE  🔋82% │
├──────────────────────────────────┤
│  学习报告                    👤  │
├──────────────────────────────────┤
│  [每日]   周报    月报           │
│  ─────                          │
├──────────────────────────────────┤
│   ◀  2026年2月24日 星期二  ▶    │
│          （今天）                │
├──────────────────────────────────┤
│ ┌────────────────────────────┐  │
│ │  📖 45min   ✅ 38题  🎯 86%│  │
│ │  学习时长   答题数   正确率 │  │
│ └────────────────────────────┘  │
├──────────────────────────────────┤
│  学科分布                        │
│  ┌──────────────────────┐       │
│  │      ╭──╮            │       │
│  │   ╭──╯数 ╰──╮       │  数学 │
│  │   │  学 40%  │       │  语文 │
│  │   ╰─╮      ╭╯       │  英语 │
│  │  语文╰──┬──╯英语    │  物理 │
│  │   30%   │  20%       │       │
│  │      物理10%         │       │
│  └──────────────────────┘       │
├──────────────────────────────────┤
│  今日学习时间线                   │
│                                  │
│  08:30 ── ● 数学·每日练习        │
│           │ 完成20题 正确率90%   │
│           │ [展开详情 ▼]         │
│           │                      │
│  10:15 ── ● 语文·古诗词背诵      │
│           │ 背诵3首 测试通过     │
│           │                      │
│  14:00 ── ○ 英语·阅读理解        │
│           │ 完成2篇 正确率75%   │
│           │ ⚠ 有薄弱知识点      │
│           │                      │
│  16:30 ── ● 数学·错题回顾        │
│           │ 回顾8题 掌握6题     │
│           │                      │
│  19:00 ── ● 物理·力学专项        │
│              完成8题 正确率80%   │
├──────────────────────────────────┤
│  ┌────────────────────────────┐  │
│  │ 🤖 小花老师今日点评         │  │
│  │                            │  │
│  │ "今天学习非常用功！数学     │  │
│  │  练习正确率有明显提升，     │  │
│  │  继续保持哦～英语阅读..."  │  │
│  │                            │  │
│  │         [展开全部 ▼]       │  │
│  └────────────────────────────┘  │
│                                  │
│                          ┌─────┐│
│                          │ 🧑‍🏫 ││
│                          │小花 ││
│                          └─────┘│
├──────────────────────────────────┤
│  🏠首页   📚学习   📊报告  👤我│
└──────────────────────────────────┘
```

## 元素说明

### 顶部导航栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 页面标题 | 文本 | "学习报告"，固定显示 |
| 用户头像 | 图标按钮 | 右上角，点击进入个人中心 |

### 子Tab栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 每日 | Tab项 | 默认选中，底部带高亮下划线指示器 |
| 周报 | Tab项 | 切换至E2周报页 |
| 月报 | Tab项 | 切换至E3月报页 |

### 日期选择器
| 元素 | 类型 | 说明 |
|------|------|------|
| 左箭头 | 图标按钮 | 切换至前一天 |
| 右箭头 | 图标按钮 | 切换至后一天，今天时置灰不可点 |
| 日期文本 | 文本 | 格式"YYYY年M月D日 星期X"，今天额外显示"（今天）"标签 |

### 数据概览卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 学习时长 | 数据项 | 格式"XXmin"或"Xh XXmin"，图标为书本 |
| 答题数 | 数据项 | 格式"XX题"，图标为对勾 |
| 正确率 | 数据项 | 格式"XX%"，图标为靶心；>=80%绿色，60-79%橙色，<60%红色 |

### 学科分布饼图
| 元素 | 类型 | 说明 |
|------|------|------|
| 饼图 | 图表组件 | 各学科按学习时长占比着色，最多显示6个学科，其余归入"其他" |
| 图例 | 标签列表 | 饼图右侧纵向排列，显示学科名称与百分比 |
| 学科色块 | 色块标识 | 数学-蓝色，语文-红色，英语-绿色，物理-橙色，化学-紫色，其他-灰色 |

### 学习时间线
| 元素 | 类型 | 说明 |
|------|------|------|
| 时间节点 | 时间线节点 | 左侧显示时间（HH:mm格式），圆点连接竖线 |
| 活动标题 | 文本 | 格式"学科·活动名称" |
| 摘要信息 | 文本 | 完成数量、正确率等核心数据 |
| 薄弱标记 | 标签 | 橙色警告图标+文字，有薄弱知识点时显示 |
| 展开/收起 | 可点击文本 | 展开后显示具体题目列表与知识点链接 |
| 节点状态 | 实心圆/空心圆 | 实心●表示正确率>=80%，空心○表示正确率<80% |

### AI老师点评卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 卡片容器 | 圆角卡片 | 浅蓝色背景，带小花老师头像装饰 |
| 点评标题 | 文本 | "小花老师今日点评" |
| 点评内容 | 富文本 | 默认显示前3行，超出部分折叠 |
| 展开按钮 | 可点击文本 | "展开全部 ▼"/"收起 ▲" |

### 悬浮数字人老师
| 元素 | 类型 | 说明 |
|------|------|------|
| 小花老师头像 | 悬浮按钮 | 右下角悬浮，尺寸48x48dp，可拖动 |
| 气泡提示 | 浮层 | 首次进入页面时显示引导气泡"点我聊聊今天的学习吧" |

## 交互行为

### 手势交互
| 手势 | 作用区域 | 行为 |
|------|----------|------|
| 左右滑动 | 日期选择器区域 | 切换前一天/后一天的报告 |
| 左右滑动 | 子Tab栏下方整体内容区 | 切换每日/周报/月报子Tab |
| 上下滑动 | 页面主内容区 | 滚动浏览报告内容 |
| 点击饼图扇形 | 学科分布饼图 | 选中该学科，时间线自动过滤仅显示该学科活动，再次点击取消过滤 |
| 点击时间线节点 | 时间线列表 | 展开/收起该活动的详细信息 |
| 长按时间线节点 | 时间线列表 | 弹出快捷操作菜单（查看详情/跳转知识点） |
| 拖拽 | 小花老师悬浮头像 | 可在屏幕右侧边缘上下拖动调整位置 |

### 输入交互
| 输入方式 | 说明 |
|----------|------|
| 日期点击 | 点击日期文本弹出日历选择器，可快速跳转到指定日期 |
| 饼图筛选 | 点击饼图扇形区域后，时间线自动应用学科筛选 |

### 动画与反馈
| 动画 | 触发条件 | 效果说明 |
|------|----------|----------|
| 数据加载动画 | 页面加载/切换日期时 | 数据概览三个数值从0递增到实际值，时长300ms |
| 饼图绘制动画 | 数据加载完成 | 饼图从12点方向顺时针展开绘制，时长500ms |
| 时间线展开 | 点击时间线节点 | 详情区域高度从0展开，带弹性动画，时长250ms |
| 日期切换过渡 | 左右滑动切换日期 | 内容区域随滑动方向平移过渡，时长200ms |
| 饼图高亮 | 点击饼图扇形 | 选中扇形外扩5dp，其余扇形降低透明度至50%，时长150ms |
| 正确率变色 | 数值加载完成 | 正确率数字根据阈值渐变至目标颜色，时长200ms |

### AI老师交互
| 场景 | 交互行为 |
|------|----------|
| 首次进入当日报告 | 小花老师悬浮头像播放入场动画（从右侧滑入），显示引导气泡 |
| 点击悬浮头像 | 展开对话浮层，小花老师主动开口总结今日学习表现 |
| 今日正确率低于60% | 小花老师头像上方显示关心气泡"今天有些题目难住你了？来聊聊吧" |
| 学习时长超过2小时 | 小花老师头像上方显示鼓励气泡"今天真努力！记得休息眼睛哦" |
| 今日无学习记录 | 小花老师头像显示提醒气泡"今天还没有开始学习呢，要来一起学吗？" |
| 家长模式查看 | 小花老师自动总结孩子当日薄弱环节，并给出家长辅助建议 |

## 状态枚举

### 默认状态
- 显示当天（今天）的完整学习报告
- 右箭头置灰不可点（不可查看未来日期）
- 饼图显示全部学科，时间线按时间正序排列
- AI点评卡片默认折叠显示前3行
- 悬浮小花老师显示在右下角默认位置

### 空状态
- **当日无学习记录时**
  - 数据概览卡片显示"0min / 0题 / --"
  - 饼图区域替换为空状态插画（小花老师拿着书本等待的卡通图）
  - 时间线区域显示"今天还没有学习记录哦～"
  - AI点评卡片替换为鼓励文案"新的一天，让我们一起开始学习吧！"
  - 显示快捷入口按钮"去学习"，跳转至B1首页

### 加载状态
- 顶部日期选择器正常显示
- 数据概览卡片显示骨架屏（三个灰色矩形占位）
- 饼图区域显示圆形骨架屏
- 时间线区域显示3-4个条形骨架屏
- AI点评卡片显示矩形骨架屏
- 加载时长超过5秒显示"加载中..."提示文字

### 错误状态
- **网络异常**：页面中部显示断网插画 + "网络开小差了" + "重新加载"按钮
- **服务端错误**：页面中部显示错误插画 + "数据获取失败" + "重新加载"按钮
- **部分加载失败**：已加载的数据正常显示，失败的模块单独显示"加载失败，点击重试"

### 边界情况
| 场景 | 处理方式 |
|------|----------|
| 查看注册前的日期 | 左箭头置灰不可点，最早可查看至注册当天 |
| 学科数量超过6个 | 饼图显示Top5学科，其余归入"其他"，图例中"其他"可展开查看明细 |
| 时间线活动超过20条 | 默认显示前10条，底部显示"查看更多"按钮，点击加载剩余 |
| 正确率为100% | 正确率显示金色，附带星星动效 |
| 跨天学习（23:50-00:10） | 按活动开始时间归属当天 |
| 家长模式 vs 学生模式 | 家长模式额外显示"与班级平均对比"数据行，学生模式不显示 |
| AI点评内容过长（>500字） | 折叠状态显示前3行+省略号，展开后完整显示并可滚动 |

## 导航关系

### 从哪来
| 来源页面 | 触发方式 | 传入参数 |
|----------|----------|----------|
| B1 首页 | 点击底部Tab"学习报告" | 无（默认显示今天） |
| B2 学习主页 | 点击底部Tab"学习报告" | 无（默认显示今天） |
| E2 周报 | 点击子Tab"每日" | 无（恢复上次查看的日期） |
| E3 月报 | 点击子Tab"每日" | 无（恢复上次查看的日期） |
| 推送通知 | 点击"今日学习报告已生成"推送 | date（指定日期） |

### 到哪去
| 目标页面 | 触发方式 | 传出参数 |
|----------|----------|----------|
| E2 周报 | 点击子Tab"周报" | 当前查看日期所在周 |
| E3 月报 | 点击子Tab"月报" | 当前查看日期所在月 |
| D4 知识点详情 | 点击时间线展开详情中的知识点标签 | knowledge_point_id |
| D5 知识点练习 | 点击时间线中"薄弱知识点"后的"去练习"按钮 | knowledge_point_id, source="daily_report" |
| 对话浮层 | 点击悬浮小花老师头像 | context="daily_report", date |
