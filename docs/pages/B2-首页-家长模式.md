# B2 首页-家长模式

## 页面信息
- **所属模块**：首页模块（B）
- **页面类型**：Tab页（底部导航第一个Tab）
- **数字人老师**：小/右上角悬浮
- **支持模式**：家长

## 线框图

```
┌──────────────────────────────────┐
│ 状态栏（系统）                    │
├──────────────────────────────────┤
│                        ┌──────┐  │
│  小明妈妈，您好         │小花  │  │
│  2026年2月24日 周二     │老师  │  │
│                        │(悬浮)│  │
│                        └──────┘  │
├──────────────────────────────────┤
│  孩子切换                        │
│ ┌──────────┐  ┌──────────┐      │
│ │  [头像]   │  │  [头像]   │ ··  │
│ │   小明    │  │   小红    │      │
│ │  三年级   │  │  一年级   │      │
│ │ ●选中     │  │          │      │
│ └──────────┘  └──────────┘      │
│    ← 左右滑动切换孩子 →          │
├──────────────────────────────────┤
│                                  │
│  今日学习概况                     │
│ ┌────────────────────────────┐   │
│ │  学习时长        完成率     │   │
│ │  45分钟          60%       │   │
│ │  ████░░░░       ██████░░  │   │
│ │                            │   │
│ │  今日已完成 3/5 项任务      │   │
│ │  点击查看详情 >             │   │
│ └────────────────────────────┘   │
│                                  │
│  成绩趋势                  本周 > │
│ ┌────────────────────────────┐   │
│ │ 100│                       │   │
│ │  90│       ·               │   │
│ │  80│   · ·   ·   ·        │   │
│ │  70│ ·           · ·      │   │
│ │  60│                       │   │
│ │    └──┬──┬──┬──┬──┬──┬──  │   │
│ │      一 二 三 四 五 六 日   │   │
│ │  ● 语文  ● 数学  ● 英语    │   │
│ └────────────────────────────┘   │
│                                  │
│  学科表现                         │
│ ┌─────────┐┌─────────┐          │
│ │ 语文     ││ 数学     │          │
│ │ 85分 ↑3  ││ 78分 ↓2  │          │
│ │ 阅读理解  ││ 应用题   │          │
│ │ 需加强   ││ 需加强   │          │
│ └─────────┘└─────────┘          │
│ ┌─────────┐┌─────────┐          │
│ │ 英语     ││ 综合     │          │
│ │ 92分 ↑5  ││ 查看全部> │          │
│ │ 表现优秀  ││          │          │
│ └─────────┘└─────────┘          │
│                                  │
│  AI 老师周报提醒            [详情]│
│ ┌────────────────────────────┐   │
│ │ 💡 小明本周数学有明显进步，  │   │
│ │    分数运算正确率提升了15%，  │   │
│ │    建议继续巩固应用题...     │   │
│ │              查看完整报告 >  │   │
│ └────────────────────────────┘   │
│                                  │
├──────────────────────────────────┤
│  [首页]  学习计划  学习报告  我的  │
│   ●                              │
└──────────────────────────────────┘
```

## 元素说明

### 顶部问候区域
| 元素 | 类型 | 说明 |
|------|------|------|
| 问候语 | 文本 | 显示家长称呼（如"小明妈妈"），字号18sp，加粗，根据声纹识别结果显示对应称呼 |
| 日期显示 | 文本 | 显示当前日期和星期，字号14sp，次要文字色 |
| 小花老师悬浮头像 | 3D数字人缩略 | 右上角悬浮球，尺寸56x56dp，圆形裁切，有未读消息时显示红色气泡角标。点击展开 AI 对话面板（底部半屏浮层），家长可通过语音或文字与小花老师对话沟通，了解当前选中孩子的学习情况、薄弱项、学习建议等。对话面板顶部显示当前孩子名称，切换孩子后对话上下文自动切换。面板底部设有「退出家长模式」按钮，点击后退出家长首页，返回 A3 AI老师欢迎对话页，重新进行身份选择 |

### 孩子切换区域
| 元素 | 类型 | 说明 |
|------|------|------|
| 区域标题 | 文本 | "孩子切换"，字号14sp |
| 孩子卡片 | 横向滚动列表 | 每个卡片宽度120dp，高度100dp，圆角16dp，含头像（48dp圆形）、姓名、年级信息 |
| 选中态指示 | 圆点指示器 | 当前选中孩子卡片底部显示主题色圆点，卡片边框变为主题色 |
| 滑动指示 | 分页圆点 | 多个孩子时底部显示分页圆点，提示可左右滑动 |

### 今日学习概况卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 卡片容器 | 圆角卡片 | 圆角16dp，白色背景，阴影elevation 4dp，可点击展开详情 |
| 学习时长 | 数据项 | 左侧显示，大字号24sp数值+单位，下方进度条（目标时长对比） |
| 完成率 | 数据项 | 右侧显示，大字号24sp百分比，下方进度条（已完成/总任务数） |
| 任务完成数 | 文本 | "今日已完成 X/Y 项任务"，字号14sp |
| 查看详情入口 | 文本按钮 | 右箭头指示，点击展开卡片显示每项任务的详细完成情况 |

### 成绩趋势图表
| 元素 | 类型 | 说明 |
|------|------|------|
| 区域标题 | 文本 | "成绩趋势"，字号16sp，加粗 |
| 时间维度切换 | 文本按钮 | 右侧显示"本周 >"，可切换本周/本月/本学期 |
| 折线图 | 图表组件 | 横轴为日期，纵轴为分数（0-100），按学科分色显示折线 |
| 学科图例 | 标签组 | 图表下方，彩色圆点+学科名称，可点击切换单科/全科显示 |
| 数据点交互 | 图表功能 | 点击折线上的数据点，弹出浮层显示具体信息（日期、科目、分数、对应练习名称） |

### 学科表现卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 学科卡片 | 网格布局 | 2x2网格排列，每个卡片圆角12dp，高度80dp |
| 分数与趋势 | 数据项 | 大字号显示当前平均分，旁边箭头+数值显示对比上周变化，上升绿色/下降红色 |
| 薄弱提示 | 文本 | 底部小字显示该学科需要加强的知识点，字号12sp，警示色 |
| 查看全部 | 入口卡片 | 第四个位置为"查看全部"入口，点击进入学科详情报告页 |

### AI老师周报提醒卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 卡片容器 | 圆角卡片 | 浅蓝色背景底色，左侧灯泡图标，圆角12dp |
| 摘要文本 | 文本 | 显示AI生成的本周学习摘要，最多3行，超出显示省略号，字号14sp |
| 查看完整报告 | 文本按钮 | 右箭头指示，点击跳转E1/E2/E3学习报告详情页 |

### 底部Tab栏
| 元素 | 类型 | 说明 |
|------|------|------|
| Tab栏 | 底部导航 | 固定底部，高度56dp，白色背景，顶部1px分割线 |
| 首页 | Tab项 | 当前选中态，主题色图标+文字 |
| 学习计划 | Tab项 | 默认态，点击跳转C2学习计划页 |
| 学习报告 | Tab项 | 默认态，有新报告时显示红点角标 |
| 我的 | Tab项 | 默认态，点击跳转F1个人中心 |

## 交互行为

### 手势交互
- **左右滑动切换孩子**：在孩子卡片区域水平滑动，切换当前查看的孩子数据。切换时下方所有数据卡片播放淡入淡出过渡动画（200ms），小花老师同步更新播报内容
- **下拉刷新**：下拉触发全页数据刷新，拉取最新的学习数据和报告
- **上滑浏览**：页面整体可垂直滚动，浏览所有卡片内容
- **点击展开概况卡片**：点击"今日学习概况"卡片，卡片高度展开（动画300ms），显示每项任务的详细完成情况列表
- **再次点击收起**：展开状态下再次点击标题区域，卡片收起回默认高度
- **点击学科卡片**：进入该学科的详细报告页面，查看具体知识点掌握情况
- **长按趋势图表**：展示十字准星，随手指移动显示对应日期的各科详细分数

### 输入交互
- **声纹自动识别**：App启动时通过麦克风进行声纹识别，自动判断是家长还是学生，自动切换到对应模式首页
- **点击悬浮小花老师**：展开底部半屏 AI 对话面板，面板包含以下区域：
  - **顶部栏**：当前孩子名称 + 关闭按钮
  - **对话区域**：与小花老师的对话消息列表，支持上下滚动查看历史
  - **底部输入栏**：与 ChatInputBar 一致，支持文字输入和按住说话语音输入
  - **退出家长模式按钮**：对话面板底部安全区域上方，文字链接样式「退出家长模式」，点击弹出确认弹窗「退出后将返回欢迎页面，确定退出吗？」，确认后跳转到 A3 AI老师欢迎对话页
- **语音指令**：支持"小花老师，小明这周数学怎么样""帮我看看小红的学习报告"等自然语言查询
- **对话内容范围**：家长可询问的话题包括但不限于：
  - 孩子当前学习进度和完成情况（"小明今天学了什么"）
  - 各学科成绩趋势分析（"小明数学最近怎么样"）
  - 薄弱知识点和提升建议（"小红英语需要加强哪些方面"）
  - 学习计划调整建议（"需要给小明调整学习计划吗"）
  - 多孩对比分析（"小明和小红谁学习更努力"）
  - 学习习惯和时间管理建议

### 动画与反馈
- **悬浮球呼吸灯**：右上角小花老师悬浮球有微弱的呼吸灯光效果，提示家长可以点击互动
- **悬浮球弹跳提醒**：有新消息需要播报时，悬浮球向上弹跳2次（每次200ms），并显示红色气泡角标
- **数据刷新动画**：学习时长和完成率数值变化时，数字从旧值平滑过渡到新值（数字滚动效果，500ms）
- **趋势图绘制动画**：进入页面时，折线图从左到右逐步绘制（800ms），数据点依次弹出
- **孩子切换过渡**：切换孩子时，所有数据卡片整体向滑动方向移出，新数据从对侧移入（300ms）
- **卡片展开收起**：概况卡片展开/收起带弹性动画效果（spring animation）

### AI 老师交互
- **进入页面自动播报**：家长打开App后，小花老师悬浮球主动弹出语音气泡，触发条件及对应内容如下：
  - **有新周报未读**："小明妈妈您好！小明这周的学习周报已经出来了，整体表现不错，数学进步了15%哦，要看看详细报告吗？"
  - **成绩明显进步**："好消息！小明最近英语成绩提升很明显，特别是听力部分，继续保持就好啦~"
  - **成绩明显下滑**："小明妈妈，需要注意一下，小明最近数学应用题的正确率下降了不少，建议增加一些专项练习。"
  - **普通进入（无特殊事件）**："小明妈妈您好！今天小明完成了3项学习任务，学习了45分钟。"
- **主动建议推送**：当检测到孩子连续3天某学科正确率低于60%，小花老师主动弹出建议卡片："建议调整一下小明的数学学习计划，增加XX知识点的练习"
- **对话面板问答**：家长在对话面板中可自由与小花老师沟通。AI 基于当前选中孩子的学习数据生成个性化回答，支持多轮对话。例如：
  - 家长："小明数学最近怎么样？" → AI："小明这周数学有明显进步，分数运算正确率提升了15%，但应用题还需要加强。建议增加一些应用题专项练习。"
  - 家长："那帮他调整一下学习计划吧" → AI："好的，我建议每周增加2小时的数学应用题练习。要现在去调整学习计划吗？"（提供跳转 C1 学习计划创建的快捷按钮）
- **多孩切换播报**：切换到不同孩子时，小花老师自动更新播报内容："切换到小红的数据了。小红今天完成了全部任务，表现很棒！"若对话面板已展开，切换孩子后面板自动提示"已切换到小红，有什么想了解的吗？"
- **退出家长模式**：对话面板中点击「退出家长模式」→ 确认弹窗 → 跳转 A3 AI老师欢迎对话页，重新进行身份选择。适用于家长想让孩子接手使用 App 的场景

## 状态枚举

### 默认状态
- 页面正常加载完成，显示家长称呼和日期
- 悬浮小花老师播放微呼吸动画
- 默认选中第一个孩子（通常是最近活跃的孩子）
- 所有数据卡片显示当前选中孩子的最新数据
- 趋势图默认显示本周数据
- 底部Tab栏首页项高亮

### 空状态
- **无孩子数据**：家长首次登录但尚未添加孩子时，孩子切换区域显示空状态，大按钮"添加孩子"，引导文案"先添加孩子信息，开始AI辅导之旅吧"
- **孩子无学习记录**：孩子刚加入但未开始学习时，概况卡片显示"小明还没有开始学习哦"，趋势图显示空白坐标轴，底部引导"让孩子打开App开始第一课吧"
- **无周报**：AI周报卡片区域不显示（非空状态卡片，直接隐藏该模块）
- **网络不可用但有缓存**：显示上次缓存数据，顶部横幅提示"网络不可用，显示的是上次同步的数据"，数据刷新时间戳显示在概况卡片右上角

### 加载状态
- **首次加载**：骨架屏显示，孩子头像区域为灰色圆形脉冲，数据卡片为灰色矩形条纹脉冲动画，持续至数据返回
- **切换孩子加载**：切换孩子后，数据区域显示轻量级加载指示（卡片内容区域半透明+居中小型加载圆圈），不阻塞页面其他操作
- **下拉刷新加载**：顶部圆形进度指示器旋转，直到数据拉取完毕
- **图表数据加载**：折线图区域显示"数据加载中..."占位文字

### 错误状态
- **网络错误**：数据卡片区域显示网络异常提示，"网络连接失败，请检查后重试"+"重新加载"按钮，已有缓存数据则显示缓存并在顶部加横幅提示
- **数据同步失败**：概况卡片右上角显示橙色警示图标，提示"数据可能不是最新的"，附带重试按钮
- **AI播报失败**：悬浮球角标变为感叹号，点击后显示"AI老师暂时无法连接，稍后再试"
- **图表渲染失败**：图表区域显示静态数据表格替代，保证数据可读

### 边界情况
- **单个孩子**：孩子切换区域仍然显示，但隐藏滑动指示器和分页圆点，卡片居中显示
- **孩子数量较多（>4）**：卡片区域支持水平滚动，显示分页圆点（最多5个点，超出用省略样式），右侧显示渐变遮罩提示可继续滑动
- **数据量极大**：成绩趋势图在"本学期"维度下，数据点过多时自动聚合为周均值显示，避免折线过于密集
- **分数为0或未参加**：学科卡片中对应科目显示"--"而非0分，下方备注"暂无成绩数据"
- **家长未完成设置**：如果孩子的年级、教材版本等信息未完善，顶部显示黄色引导条"完善孩子信息，获取更精准的学习建议"，点击跳转设置页
- **深夜访问**：22:00后打开，AI播报简短化，不主动弹出语音，仅显示文字摘要，降低打扰
- **通知权限未开启**：首次进入时底部弹出引导条"开启通知权限，及时收到孩子的学习进展提醒"，提供"去开启"和"暂不"按钮

## 导航关系

### 从哪来
| 来源页面 | 场景说明 |
|----------|----------|
| A1 启动页 | 老用户直接登录，声纹识别为家长身份后自动进入 |
| A3b 家长注册引导 | 新家长完成注册引导流程后首次进入 |
| B1 学生首页 | 通过身份切换（个人中心->切换身份）从学生模式切换到家长模式 |
| 其他Tab页 | 从学习计划/学习报告/个人中心Tab切换回首页 |

### 到哪去
| 目标页面 | 触发条件 |
|----------|----------|
| C2 学习计划 | 点击底部Tab"学习计划" |
| E1 学习周报 | 点击AI老师周报卡片"查看完整报告"，或点击底部Tab"学习报告" |
| E2 学科详细报告 | 点击学科表现卡片中的具体学科 |
| E3 学习趋势报告 | 点击成绩趋势图表区域的"本周 >"切换维度后的详情入口 |
| F1 个人中心 | 点击底部Tab"我的" |
| 孩子信息设置 | 点击孩子卡片上的编辑入口，或点击未完善信息引导条 |
| 添加孩子页面 | 空状态下点击"添加孩子"按钮，或孩子卡片末尾的"+"按钮 |
| AI对话面板 | 点击右上角小花老师悬浮球，展开底部半屏对话面板，可对话沟通孩子学习情况 |
| C1 学习计划创建 | 在 AI 对话面板中，小花老师建议调整计划时提供的快捷跳转按钮 |
| A3 AI老师欢迎对话 | 在 AI 对话面板中点击「退出家长模式」并确认后跳转，重新进行身份选择 |
