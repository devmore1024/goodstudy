# C3 测评设置

## 页面信息
- **所属模块**：C - 学习计划模块（测评子模块）
- **页面类型**：全屏页
- **数字人老师**：大/居中（上半区引导） → 滚动后缩小为右上角悬浮
- **支持模式**：通用（学生自主测评 / 家长为孩子设置测评）

## 线框图

```
┌──────────────────────────────────┐
│ ←  测评设置              [老师]  │
├──────────────────────────────────┤
│                                  │
│        ┌──────────────┐          │
│        │   数字人老师   │          │
│        │  "来测测看你   │          │
│        │   最近学得     │          │
│        │   怎么样吧！"  │          │
│        └──────────────┘          │
│                                  │
│  ┌──────────────────────────┐    │
│  │  选择测评科目             │    │
│  │                           │    │
│  │  ┌──────┐  ┌──────┐      │    │
│  │  │      │  │      │      │    │
│  │  │  数学 │  │  英语 │      │    │
│  │  │ ★85分│  │ ★72分│      │    │
│  │  │[选中] │  │      │      │    │
│  │  └──────┘  └──────┘      │    │
│  │                           │    │
│  │  ┌──────┐  ┌──────┐      │    │
│  │  │      │  │      │      │    │
│  │  │  语文 │  │  物理 │      │    │
│  │  │ ★78分│  │ ★90分│      │    │
│  │  │      │  │      │      │    │
│  │  └──────┘  └──────┘      │    │
│  │                           │    │
│  │  ┌──────┐  ┌──────┐      │    │
│  │  │      │  │      │      │    │
│  │  │  化学 │  │  生物 │      │    │
│  │  │ 新科目│  │ ★88分│      │    │
│  │  │      │  │      │      │    │
│  │  └──────┘  └──────┘      │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │  测评参数 (AI推荐)        │    │
│  │                           │    │
│  │  难度等级                 │    │
│  │  ┌───┐ ┌───┐ ┌───┐      │    │
│  │  │基础│ │进阶│ │挑战│      │    │
│  │  │   │ │推荐│ │   │      │    │
│  │  └───┘ └───┘ └───┘      │    │
│  │                           │    │
│  │  题目数量                 │    │
│  │  ┌──┐ ┌──┐ ┌──┐ ┌──┐    │    │
│  │  │10│ │15│ │20│ │30│    │    │
│  │  │  │ │推荐│ │  │ │  │    │    │
│  │  └──┘ └──┘ └──┘ └──┘    │    │
│  │                           │    │
│  │  时间限制                 │    │
│  │  ━━━━━━━━●━━━━  30分钟   │    │
│  │  (AI推荐: 30分钟)         │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │  历史成绩对比             │    │
│  │                           │    │
│  │  数学成绩趋势             │    │
│  │  100│                     │    │
│  │   90│        ·            │    │
│  │   80│  ·  ·     ·  ★     │    │
│  │   70│                     │    │
│  │   60│·                    │    │
│  │     └──┬──┬──┬──┬──┬──   │    │
│  │      1月 1月 1月 2月 2月   │    │
│  │      w1 w3 w5 w1 w3      │    │
│  │                           │    │
│  │  ★ 最近一次: 85分         │    │
│  │  ↑ 较上次提升 5分          │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │       开始测评 →          │    │
│  └──────────────────────────┘    │
│                                  │
└──────────────────────────────────┘
```

### 科目卡片选中态

```
┌────────────────┐
│   ┌──────────┐ │
│   │  ✓       │ │  ← 右上角勾选标记
│   │          │ │
│   │   📐     │ │  ← 科目图标（动态）
│   │   数学    │ │
│   │  ★85分   │ │  ← 上次成绩
│   │          │ │
│   └──────────┘ │
│  蓝色边框+背景  │
│  图标有弹跳动画  │
└────────────────┘
```

## 元素说明

| 序号 | 元素名称 | 类型 | 说明 |
|------|---------|------|------|
| 1 | 导航栏 | 固定顶栏 | 左侧返回按钮，中间标题"测评设置"，右侧AI老师小头像（滚动后显示） |
| 2 | AI老师引导区 | 动态组件 | 页面顶部AI老师大尺寸显示，播放引导语音，向下滚动时渐隐缩小为右上角悬浮 |
| 3 | 科目选择区 | 大按钮卡片网格 | 2列网格布局，每个卡片约120x120pt，包含：科目图标（彩色矢量图标）、科目名称、上次测评分数（无则显示"新科目"），支持多选 |
| 4 | 科目卡片 | 可选卡片 | 未选中：白色背景+浅灰边框；选中：蓝色渐变背景+蓝色边框+右上角勾选标记+图标弹跳动画 |
| 5 | 难度选择器 | 单选按钮组 | 三个选项：基础/进阶/挑战，AI推荐项标注"推荐"标签，选中态有填充色变化 |
| 6 | 题目数量选择器 | 单选按钮组 | 四个选项：10/15/20/30题，AI推荐项标注"推荐"标签 |
| 7 | 时间限制滑块 | 连续滑块 | 范围15-60分钟，步进5分钟，显示当前值和AI推荐值，滑块轨道有渐变色（绿→黄→红） |
| 8 | 历史成绩折线图 | 图表组件 | 显示选中科目（第一个）的历史测评成绩趋势，横轴为时间（最近6次），纵轴为分数，最近一次用星标标注，下方显示与上次的对比 |
| 9 | 开始测评按钮 | 主按钮 | 固定底部，选择科目后激活，显示"开始测评 →"，未选科目时灰色禁用 |

## 交互行为

### 手势交互
- **纵向滚动**：页面整体纵向滚动，AI老师区域滚动时缩小上移至导航栏右侧
- **科目卡片点击选中/取消**：点击切换选中状态，支持多选多个科目（综合测评）
- **滑块拖拽**：左右拖拽时间限制滑块调整时长

### 输入交互
- **科目选择**：点击科目卡片选中/取消，至少选择1个科目才能开始测评
- **难度选择**：点击难度选项切换，单选
- **题目数量选择**：点击数量选项切换，单选
- **时间调整**：拖拽滑块或点击滑块轨道上的位置快速跳转
- **AI语音调整**：可通过语音对AI老师说"难度调高一点""多出几道题"等自然语言，AI自动调整对应参数

### 动画与反馈
- **页面进入**：AI老师从底部弹起+欢迎语音，科目卡片依次从下方弹入（间隔100ms）
- **科目选中动画**：卡片选中时：① 边框从灰色变为蓝色（200ms） ② 背景渐变填充（200ms） ③ 科目图标弹跳放大再缩回（300ms，1.0→1.2→1.0） ④ 右上角勾选标记旋转弹入
- **科目取消动画**：反向播放选中动画，勾选标记缩小消失
- **AI推荐标签**：推荐项的"推荐"标签有微弱的呼吸发光效果
- **折线图动画**：切换选中科目时折线图数据点依次从下方升起（每点间隔80ms），连线跟随绘制
- **按钮激活**：选择科目后开始按钮从灰色渐变为蓝色，伴随微弱弹跳
- **触觉反馈**：科目选中/取消时触发轻微震动

### AI 老师交互
- **进入引导**：AI老师语音介绍："来测一测最近学得怎么样吧！选择你想测评的科目，我来帮你出题！"
- **科目选择反馈**：选中科目后AI老师语音反馈，如选数学："数学上次考了85分，这次争取90分以上！"
- **参数推荐解释**：用户点击AI推荐的参数时，AI老师语音解释推荐理由："根据你的水平，进阶难度最适合你，太简单了没挑战哦"
- **多科目提醒**：选择超过3个科目时，AI老师提醒："选了好多科目呀，测评时间会比较长，建议一次测1-2个科目效果更好哦"
- **历史成绩评价**：切换科目时AI老师对该科目成绩趋势做简短评价："数学进步很大，一直在往上走！"

## 状态枚举

### 默认状态
- AI老师大尺寸居中显示，播放引导语
- 科目卡片全部未选中，显示各科目上次成绩
- 参数区域显示AI推荐值（已预选）
- 历史成绩图表为空（等待选中科目后显示）
- 开始按钮灰色禁用

### 空状态（无历史测评记录）
- 科目卡片不显示分数，改为"首次测评"标签
- 历史成绩区域不显示，替换为AI老师的鼓励语："第一次测评不要紧张，我们来看看你现在的水平吧！"
- 参数使用默认推荐值（中等难度、15题、30分钟）

### 加载状态
- 科目卡片显示骨架屏
- 历史成绩图表显示加载占位
- AI老师播放"思考"动画

### 错误状态
- 科目数据加载失败：显示"科目信息加载失败，请重试"，提供重试按钮
- 历史数据加载失败：科目卡片正常显示但无分数，历史图表区域显示"暂时无法获取历史成绩"

### 边界情况
- **仅有1个科目可测评**：该科目自动选中，科目选择区收起，直接展示参数设置
- **多科目综合测评**：选择多个科目时，题目数量自动调整（每科至少5题），时间限制相应增加，AI老师说明综合测评规则
- **家长模式**：家长模式下额外显示"测评通知"开关——开启后测评完成时推送通知给家长
- **上次测评时间较远**：若距上次测评超过30天，AI老师特别提醒："好久没测评啦，可能需要从基础难度开始热热身"
- **连续测评限制**：若距上次测评不足24小时，AI老师温和劝阻："昨天刚测过，建议学习一段时间再测效果更好哦"，但不强制阻止

## 导航关系

### 从哪来
- **C2 学习计划总览**：点击周视图中的测评色块，或从计划设置中进入，可能携带预选科目参数
- **B1 学生首页**：点击"开始测评"入口卡片
- **B2 家长首页**：点击"安排测评"入口

### 到哪去
- **C4 测评进行中**：点击"开始测评"按钮后跳转，携带科目、难度、题数、时限参数
- **返回上一页**：点击返回按钮回到来源页
