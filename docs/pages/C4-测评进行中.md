# C4 测评进行中

## 页面信息
- **所属模块**：C - 学习计划模块（测评子模块）
- **页面类型**：全屏页（沉浸式，隐藏系统状态栏）
- **数字人老师**：小/右上角悬浮
- **支持模式**：学生（测评执行） / 家长模式不可进入此页面

## 线框图

```
┌──────────────────────────────────┐
│  ✕ 退出        ⏱ 25:30   [老师] │
├──────────────────────────────────┤
│                                  │
│  ┌──────────────────────────┐    │
│  │ 答题进度                  │    │
│  │ ●●●●●●●○○○○○○○○          │    │
│  │        ↑第7题             │    │
│  │ 7/15题  已答6题 标记1题   │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │                           │    │
│  │  第 7 题          数学    │    │
│  │  (单选题)                 │    │
│  │                           │    │
│  │  已知函数 f(x) = 2x² +   │    │
│  │  3x - 1，求 f(2) 的值    │    │
│  │  是多少？                 │    │
│  │                           │    │
│  │  ┌────────────────────┐   │    │
│  │  │ A. 11              │   │    │
│  │  └────────────────────┘   │    │
│  │  ┌────────────────────┐   │    │
│  │  │ B. 13    ✓ (已选)  │   │    │
│  │  └────────────────────┘   │    │
│  │  ┌────────────────────┐   │    │
│  │  │ C. 15              │   │    │
│  │  └────────────────────┘   │    │
│  │  ┌────────────────────┐   │    │
│  │  │ D. 17              │   │    │
│  │  └────────────────────┘   │    │
│  │                           │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │  🚩标记本题              │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌────────┐      ┌────────┐     │
│  │ ← 上一题│      │ 下一题 →│     │
│  └────────┘      └────────┘     │
│                                  │
│  ┌──────────────────────────┐    │
│  │        提交测评            │    │
│  └──────────────────────────┘    │
│                                  │
└──────────────────────────────────┘
```

### 答题进度导航展开态

```
┌──────────────────────────────────┐
│                                  │
│  答题进度导航                    │
│  ┌──┬──┬──┬──┬──┬──┬──┬──┐     │
│  │1 │2 │3 │4 │5 │6 │7 │8 │     │
│  │✓ │✓ │✓ │✓ │🚩│✓ │● │○ │     │
│  ├──┼──┼──┼──┼──┼──┼──┼──┤     │
│  │9 │10│11│12│13│14│15│  │     │
│  │○ │○ │○ │○ │○ │○ │○ │  │     │
│  └──┴──┴──┴──┴──┴──┴──┴──┘     │
│                                  │
│  ✓已答  ●当前  ○未答  🚩已标记   │
│                                  │
│  ┌──────────────────────────┐    │
│  │        收起导航            │    │
│  └──────────────────────────┘    │
└──────────────────────────────────┘
```

### 计时器最后5分钟状态

```
┌──────────────────────────────────┐
│  ✕ 退出    ⏱ 04:32 (红色闪烁)   │
│            ⚠️ 剩余不足5分钟      │
└──────────────────────────────────┘
```

### 提交确认弹窗

```
┌──────────────────────────────────┐
│                                  │
│    ┌────────────────────────┐    │
│    │                        │    │
│    │    确认提交测评？        │    │
│    │                        │    │
│    │  已答: 13题             │    │
│    │  未答: 1题              │    │
│    │  已标记: 1题            │    │
│    │                        │    │
│    │  ⚠️ 还有1题未作答，      │    │
│    │  提交后不可修改          │    │
│    │                        │    │
│    │  ┌──────┐ ┌──────┐     │    │
│    │  │ 继续答题│ │ 确认提交│     │    │
│    │  └──────┘ └──────┘     │    │
│    │                        │    │
│    └────────────────────────┘    │
│                                  │
└──────────────────────────────────┘
```

### 退出确认弹窗

```
┌──────────────────────────────────┐
│                                  │
│    ┌────────────────────────┐    │
│    │                        │    │
│    │    确定退出测评吗？      │    │
│    │                        │    │
│    │  退出后本次测评将不会    │    │
│    │  保存，需要重新开始      │    │
│    │                        │    │
│    │  ┌──────┐ ┌──────┐     │    │
│    │  │ 继续测评│ │ 确认退出│     │    │
│    │  └──────┘ └──────┘     │    │
│    │                        │    │
│    └────────────────────────┘    │
│                                  │
└──────────────────────────────────┘
```

## 元素说明

| 序号 | 元素名称 | 类型 | 说明 |
|------|---------|------|------|
| 1 | 顶部工具栏 | 固定顶栏 | 左侧"✕退出"按钮（需二次确认），中间倒计时器，右侧AI老师悬浮小头像 |
| 2 | 倒计时器 | 动态组件 | 显示剩余时间（分:秒），正常为白色，最后5分钟变红色并闪烁，最后1分钟加速闪烁 |
| 3 | 答题进度条 | 导航组件 | 圆点序列表示每道题状态：实心蓝=已答、实心蓝+旗标=已标记、空心蓝+圆环=当前题、空心灰=未答。点击可展开为网格导航面板 |
| 4 | 题目卡片 | 内容区域 | 显示题号、题型标签（单选/多选/填空/解答）、科目标签、题目内容（支持数学公式LaTeX渲染、图片） |
| 5 | 选项列表 | 可选列表 | 单选题：A/B/C/D选项卡片，点击选中（蓝色填充+勾选标记）；多选题：可多选，选中后再点取消 |
| 6 | 标记按钮 | 功能按钮 | 旗帜图标+"标记本题"，点击后该题在进度条标记为旗帜，方便回顾 |
| 7 | 上/下一题按钮 | 导航按钮 | 底部左右布局，第1题时"上一题"隐藏，最后1题时"下一题"变为"查看全部" |
| 8 | 提交按钮 | 主按钮 | 底部居中，点击触发二次确认弹窗 |
| 9 | 提交确认弹窗 | 模态弹窗 | 显示答题统计（已答/未答/已标记），有未答题时显示警告提示，双按钮"继续答题"/"确认提交" |
| 10 | 退出确认弹窗 | 模态弹窗 | 警告退出将丢失进度，双按钮"继续测评"/"确认退出" |
| 11 | AI老师悬浮头像 | 悬浮组件 | 右上角小头像，答题中保持安静，仅在特定时机给出提示 |

## 交互行为

### 手势交互
- **左右滑动切题**：在题目卡片区域左右滑动切换上一题/下一题，带平滑滑动过渡动画（题目卡片左滑出+新题右滑入）
- **点击进度圆点跳题**：点击顶部进度条的任意圆点直接跳转到对应题目
- **点击进度条展开导航**：点击进度条区域展开全题号网格面板，可点击任意题号跳转
- **上下滑动**：题目内容过长时（如解答题）可纵向滚动查看完整题目

### 输入交互
- **选择答案**：单选题点击选项选中（再点其他选项切换）；多选题点击选中/取消
- **填空题输入**：点击填空位置弹出键盘，支持数字/文字/公式输入
- **解答题输入**：提供文本输入区域，支持手写识别（调用系统手写板）
- **标记题目**：点击"标记本题"按钮，再次点击取消标记
- **提交测评**：点击提交按钮 → 弹出确认弹窗 → 确认后提交

### 动画与反馈
- **切题动画**：题目卡片左右滑动切换，新题目从对应方向滑入，耗时250ms，带轻微回弹
- **选中答案动画**：选项卡片点击选中时：背景从白色渐变为浅蓝（150ms），右侧勾选标记弹入（200ms缩放动画），触发轻微震动
- **取消选中动画**：背景渐变回白色，勾选标记缩小消失
- **进度更新动画**：完成一题后对应进度圆点从空心变实心，有颜色填充动画
- **计时器告警**：最后5分钟计时器变红，数字放大后缩回（脉冲效果），每30秒闪烁一次；最后1分钟每5秒闪烁一次
- **标记动画**：旗帜图标弹入+轻微旋转，取消时旗帜飞出
- **提交弹窗动画**：弹窗从底部弹起，背景遮罩渐显
- **超时自动提交**：时间归零时自动触发提交，倒计时器显示"00:00"闪烁3次后自动提交

### AI 老师交互
- **开始鼓励**：进入页面时AI老师小声说："加油哦，认真审题，我相信你可以的！"然后保持安静
- **中途不干扰**：答题过程中AI老师不主动说话，避免打断思路
- **时间提醒**：剩余5分钟时AI老师温和提醒："还有5分钟哦，没做完的题先选一个答案"
- **全部完成提示**：所有题目都已作答时AI老师说："所有题都答完了，要不要检查一下再提交？"
- **标记题回顾**：有标记题且准备提交时AI老师提醒："你标记了N道题还没确认，要不要再看看？"

## 状态枚举

### 默认状态
- 显示第1题，计时器开始倒计时
- 进度条全部为空心圆点
- 提交按钮正常显示
- AI老师播放开场鼓励后安静

### 加载状态
- 题目区域显示骨架屏
- 计时器暂停（不开始倒计时）
- 加载文案："正在准备题目…"
- AI老师播放等待动画

### 错误状态
- **题目加载失败**：题目区域显示"题目加载失败"，提供"重试"按钮，计时器暂停
- **提交失败**：弹窗提示"提交失败，请检查网络"，提供"重试提交"和"保存本地稍后提交"两个选项
- **网络断开**：顶部显示红色横幅"网络已断开，答题数据已本地保存"，可继续答题，网络恢复后自动同步

### 边界情况
- **时间耗尽**：倒计时归零后自动提交当前已答内容，弹出提示"时间到！已自动提交你的答案"，2秒后跳转C5
- **只剩1题未答**：进度条最后一个空心圆点有脉冲提示
- **全部标记**：所有题目都被标记时AI老师说："你标记了所有题目，是不是都觉得不确定？没关系，选你最有把握的答案就好"
- **快速答完**：在一半时间内答完所有题目，AI老师提醒："答得好快呀，时间还很充裕，要不要检查一遍？"
- **App切后台**：切后台时计时器继续倒计时（不暂停），回到前台时显示已逝去的时间，弹出提醒"测评期间请不要离开哦"
- **多科目测评**：不同科目的题目用不同颜色的科目标签区分，切换科目时有分隔页提示"接下来是英语部分"

## 导航关系

### 从哪来
- **C3 测评设置**：点击"开始测评"按钮进入，携带科目、难度、题数、时限参数，进入后立即开始倒计时

### 到哪去
- **C5 测评结果**：正常提交或超时自动提交后跳转，携带答题数据（答案、用时、标记状态）
- **C3 测评设置**：退出确认弹窗中点击"确认退出"，返回测评设置页
