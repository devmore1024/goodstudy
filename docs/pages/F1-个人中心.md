# F1 个人中心

## 页面信息
- **所属模块**：F 系列 - 账户与设置
- **页面类型**：Tab页（底部导航第四个Tab：个人中心）
- **数字人老师**：不显示
- **支持模式**：通用（学生/家长均可访问，显示内容根据当前模式有所差异）

## 线框图

```
┌──────────────────────────────────┐
│ 状态栏                       ▐██ │
├──────────────────────────────────┤
│                                  │
│  ┌────────────────────────────┐  │
│  │  🎓 当前为：学生模式       │  │
│  │     [ 切换到家长模式 → ]   │  │
│  └────────────────────────────┘  │
│                                  │
│  学生模式：                      │
│  ┌──────┐                        │
│  │      │  张小明                │
│  │ 头像 │  三年级 · 学生         │
│  │      │  手机号 138****1234    │
│  └──────┘                        │
│                                  │
│  家长模式：                      │
│  ┌──────┐                        │
│  │      │  张爸爸       [管理员]  │
│  │ 头像 │  爸爸 · 家长           │
│  │      │  手机号 138****1234    │
│  └──────┘                        │
│                                  │
│  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  │
│                                  │
│  板块 A（仅家长模式显示）        │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │ 👨‍👩‍👧‍👦 家庭成员管理        → │  │
│  │                            │  │
│  ├────────────────────────────┤  │
│  │                            │  │
│  │ 🎙 声纹管理               → │  │
│  │                            │  │
│  ├────────────────────────────┤  │
│  │                            │  │
│  │ 👑 升级会员               → │  │
│  │                            │  │
│  └────────────────────────────┘  │
│                                  │
│            （间距 20pt）          │
│                                  │
│  板块 B（学生+家长都显示）       │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │ 📚 学习设置               → │  │
│  │                            │  │
│  ├────────────────────────────┤  │
│  │                            │  │
│  │ 💬 个性化问答             → │  │
│  │                            │  │
│  ├────────────────────────────┤  │
│  │                            │  │
│  │ 📝 咨询与反馈             → │  │
│  │                            │  │
│  ├────────────────────────────┤  │
│  │                            │  │
│  │ 📋 协议与公告             → │  │
│  │                            │  │
│  ├────────────────────────────┤  │
│  │                            │  │
│  │ ℹ️ 关于我们               → │  │
│  │                            │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │       退出登录              │  │
│  └────────────────────────────┘  │
│                                  │
│                                  │
├──────────────────────────────────┤
│  🏠首页  📖学习  💬消息  👤我的 │
└──────────────────────────────────┘
```

### 模式切换二次确认弹窗

```
┌──────────────────────────────────┐
│                                  │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │                            │  │
│  │    确认切换到家长模式？     │  │
│  │                            │  │
│  │                            │  │
│  │  切换后将进入家长视角，     │  │
│  │  可查看学习报告和管理设置   │  │
│  │                            │  │
│  │                            │  │
│  │                            │  │
│  │  ┌──────┐  ┌──────────┐   │  │
│  │  │ 取消 │  │ 确认切换  │   │  │
│  │  └──────┘  └──────────┘   │  │
│  │                            │  │
│  └────────────────────────────┘  │
│                                  │
└──────────────────────────────────┘
```

弹窗内边距 28pt，标题与副文案间距 16pt，副文案与按钮间距 32pt，按钮间距 16pt。

### 退出登录二次确认弹窗

```
┌──────────────────────────────────┐
│                                  │
│  ┌────────────────────────────┐  │
│  │                            │  │
│  │                            │  │
│  │     确认退出登录？          │  │
│  │                            │  │
│  │                            │  │
│  │  退出后需重新验证手机号     │  │
│  │  才能使用                   │  │
│  │                            │  │
│  │                            │  │
│  │                            │  │
│  │  ┌──────┐  ┌──────────┐   │  │
│  │  │ 取消 │  │ 确认退出  │   │  │
│  │  └──────┘  └──────────┘   │  │
│  │                            │  │
│  └────────────────────────────┘  │
│                                  │
└──────────────────────────────────┘
```

弹窗内边距 28pt，标题与副文案间距 16pt，副文案与按钮间距 32pt，按钮间距 16pt。

## 元素说明

| 序号 | 元素名称 | 类型 | 说明 |
|------|---------|------|------|
| 1 | 模式指示卡片 | 卡片容器 | 顶部圆角卡片，显示当前身份模式（学生模式/家长模式），背景色随模式变化：学生模式为浅蓝色，家长模式为浅绿色 |
| 2 | 切换模式按钮 | 文字按钮 | 卡片内右侧，点击触发模式切换确认弹窗 |
| 3 | 用户头像 | 圆形图片 | 64x64pt，展示当前识别用户的头像，默认头像根据角色区分 |
| 4 | 用户名称 | 文本 | 主标题样式，16pt 加粗，显示当前成员姓名。家长模式下若该家长为管理员，名称右侧显示"管理员"标签（小号圆角 badge，品牌色背景白色文字） |
| 5 | 用户信息 | 文本 | 副标题样式，14pt 灰色。学生模式格式为"年级 · 学生"；家长模式格式为"称谓 · 家长"，称谓取自家长 relation 字段（如爸爸、妈妈） |
| 6 | 手机号 | 文本 | 副标题样式，14pt 灰色，中间四位脱敏显示 |
| 7 | 板块 A 菜单卡片 | 列表组 | 白色圆角卡片，**仅家长模式显示**，含管理与会员相关菜单。每项行高加大（上下各 16pt 内边距），与板块 B 间距 20pt |
| 8 | 家庭成员管理 | 列表项 | 板块 A，左侧图标 + 文字 + 右箭头，点击跳转 F2。仅管理员可在 F2 中添加/编辑家庭成员，非管理员家长进入 F2 后只能查看列表 |
| 9 | 声纹管理 | 列表项 | 板块 A，左侧图标 + 文字 + 右箭头，点击跳转 F3 |
| 9a | 升级会员 | 列表项 | 板块 A，左侧图标 + 文字 + 右箭头，暂不实现，点击 toast "即将上线" |
| 10 | 板块 B 菜单卡片 | 列表组 | 白色圆角卡片，**学生模式 + 家长模式均显示**，含通用信息菜单。每项行高加大（上下各 16pt 内边距） |
| 10a | 学习设置 | 列表项 | 板块 B，左侧图标 + 文字 + 右箭头，点击跳转 F4 |
| 10b | 个性化问答 | 列表项 | 板块 B，暂不实现，点击 toast "即将上线" |
| 10c | 咨询与反馈 | 列表项 | 板块 B，暂不实现，点击 toast "即将上线" |
| 10d | 协议与公告 | 列表项 | 板块 B，暂不实现，点击 toast "即将上线" |
| 10e | 关于我们 | 列表项 | 板块 B，左侧图标 + 文字 + 右箭头，点击跳转关于页面 |
| 12 | 退出登录按钮 | 文字按钮 | 红色文字，居中显示，独立卡片，点击触发退出确认弹窗 |
| 13 | 底部导航栏 | Tab 栏 | 四个 Tab：首页、学习、消息、我的（当前高亮） |

## 交互行为

### 手势交互
- **下拉刷新**：页面支持下拉刷新，更新用户信息和模式状态
- **列表项点击**：点击菜单项，整行高亮反馈（浅灰色背景 150ms），然后跳转对应页面
- **底部 Tab 切换**：点击其他 Tab 图标切换到对应页面，无转场动画（Tab 间直接切换）

### 输入交互
- **模式切换**：点击「切换到家长模式/学生模式」→ 弹出二次确认弹窗 → 确认后切换，页面刷新显示新模式信息
- **退出登录**：点击「退出登录」→ 弹出二次确认弹窗 → 确认后清除本地登录态，跳转到登录页（A1）

### 动画与反馈
- **模式切换动画**：确认切换后，模式指示卡片执行渐变色过渡动画（300ms ease-in-out），蓝↔绿
- **头像区域**：模式切换后头像区域信息以淡入动画（200ms）更新
- **弹窗动画**：弹窗从底部滑入（250ms），背景遮罩渐现；关闭时反向动画
- **按钮反馈**：确认按钮点击后显示 loading 状态，防止重复点击

### AI 老师交互
- 本页面不显示数字人老师，无 AI 交互

## 状态枚举

### 默认状态
- 正常显示当前识别用户的信息
- **学生模式**：用户信息区显示学生的姓名、年级、角色（学生）；仅显示板块 B 菜单
- **家长模式**：用户信息区显示家长的姓名、称谓（爸爸/妈妈等）、角色（家长）；若为管理员则名称旁显示"管理员"标签；显示板块 A + B 菜单
- 模式指示卡片显示当前模式
- 所有菜单项正常可点击

### 管理员权限
- `isAdmin` 标记在 `FamilyMember` / `UserProfile` 数据模型上
- 家长模式下，管理员在个人中心名称旁显示"管理员"badge
- 仅管理员可在 F2 家庭成员管理页面中添加、编辑、删除家庭成员
- 非管理员家长进入 F2 后只能查看成员列表，不显示添加/编辑/删除操作入口

### 空状态
- 不适用（登录后必有用户信息）

### 加载状态
- 首次进入页面时，头像和用户信息区域显示骨架屏（skeleton）
- 菜单列表区域同时显示骨架屏
- 加载完成后骨架屏渐隐，真实内容渐现（200ms）

### 错误状态
- 网络异常时页面显示已缓存的用户信息（离线优先）
- 若无缓存数据，显示错误提示："网络连接异常，请检查网络后重试"，下方显示「重试」按钮
- 模式切换失败时 toast 提示"切换失败，请重试"，弹窗不关闭

### 边界情况
- **未完成声纹录入**：声纹管理项右侧显示红点提示
- **家庭仅一人**：家庭成员管理项右侧显示提示文字"去添加"
- **长姓名处理**：用户名称超过 8 个字时尾部截断显示省略号
- **未识别身份**：若声纹未识别到具体成员，显示家庭默认账户信息，模式指示卡片提示"未识别到声纹，当前为默认身份"

## 导航关系

### 从哪来
| 来源页面 | 触发方式 | 转场动画 |
|---------|---------|---------|
| B1 首页（学生） | 点击底部 Tab「我的」 | 无转场（Tab 切换） |
| B2 首页（家长） | 点击底部 Tab「我的」 | 无转场（Tab 切换） |
| 其他 Tab 页 | 点击底部 Tab「我的」 | 无转场（Tab 切换） |

### 到哪去
| 目标页面 | 触发方式 | 转场动画 |
|---------|---------|---------|
| F2 家庭成员管理 | 点击「家庭成员管理」菜单项 | 右滑推入（push） |
| F3 声纹管理 | 点击「声纹管理」菜单项 | 右滑推入（push） |
| F4 学习设置 | 点击「学习设置」菜单项（家长模式） | 右滑推入（push） |
| 关于我们 | 点击「关于我们」菜单项 | 右滑推入（push） |
| A1 登录页 | 确认退出登录 | 渐隐切换（fade） |
