# F4 学习设置

## 页面信息
- **所属模块**：F 系列 - 账户与设置
- **页面类型**：全屏页
- **数字人老师**：不显示
- **支持模式**：家长（仅家长模式可访问和修改设置）

## 线框图

### 主界面

```
┌──────────────────────────────────┐
│ 状态栏                       ▐██ │
├──────────────────────────────────┤
│  ←  学习设置                     │
├──────────────────────────────────┤
│                                  │
│  设置对象：                      │
│  ┌──────┐ ┌──────┐ ┌──────┐    │
│  │张小明 │ │张小红 │ │ 全部 │    │
│  │ 选中✓ │ │      │ │      │    │
│  └──────┘ └──────┘ └──────┘    │
│                                  │
│  ── 学习时间 ──────────────────  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 每日学习提醒时间            │  │
│  │                            │  │
│  │ 提醒 1   16:00        [编辑]│  │
│  │ 提醒 2   19:30        [编辑]│  │
│  │                            │  │
│  │        [＋ 添加提醒]        │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 单次学习时长上限            │  │
│  │                            │  │
│  │ ◀── ──●────────── ──▶      │  │
│  │  15分钟    45分钟    90分钟  │  │
│  │                            │  │
│  │ 当前设置：45 分钟           │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 休息提醒间隔                │  │
│  │                            │  │
│  │ ◀────── ──●────── ──▶      │  │
│  │  10分钟    25分钟    45分钟  │  │
│  │                            │  │
│  │ 当前设置：25 分钟           │  │
│  │ 每学习25分钟提醒休息5分钟   │  │
│  └────────────────────────────┘  │
│                                  │
│  ── 语音与互动 ────────────────  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 语音播放语速                │  │
│  │                            │  │
│  │ ◀──── ──●──────── ──▶      │  │
│  │  0.75x   1.0x   1.25x 1.5x │  │
│  │                            │  │
│  │ 当前：1.0x   [▶ 试听]      │  │
│  └────────────────────────────┘  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ AI老师音色选择              │  │
│  │                            │  │
│  │ ○ 温柔姐姐  [▶ 试听]       │  │
│  │ ● 活力老师  [▶ 试听]       │  │
│  │ ○ 知心哥哥  [▶ 试听]       │  │
│  │ ○ 慈祥长辈  [▶ 试听]       │  │
│  └────────────────────────────┘  │
│                                  │
│  ── 护眼与健康 ────────────────  │
│                                  │
│  ┌────────────────────────────┐  │
│  │ 护眼模式          [开关 ●] │  │
│  │ 开启后屏幕色温偏暖，降低    │  │
│  │ 蓝光刺激                    │  │
│  ├────────────────────────────┤  │
│  │ 定时护眼提醒      [开关 ●] │  │
│  │ 每20分钟提醒远眺休息        │  │
│  └────────────────────────────┘  │
│                                  │
│                                  │
└──────────────────────────────────┘
```

### 时间选择器弹层

```
┌──────────────────────────────────┐
│          （页面内容变暗）          │
│                                  │
│                                  │
│  ┌────────────────────────────┐  │
│  │  设置提醒时间               │  │
│  │                            │  │
│  │     ┌────┐  ┌────┐        │  │
│  │     │ 15 │  │ 59 │        │  │
│  │     │ 16 │ :│ 00 │        │  │
│  │     │ 17 │  │ 01 │        │  │
│  │     └────┘  └────┘        │  │
│  │                            │  │
│  │  重复：                     │  │
│  │  一 二 三 四 五 六 日       │  │
│  │  ●  ●  ●  ●  ●  ○  ○      │  │
│  │                            │  │
│  │  ┌──────┐  ┌──────────┐   │  │
│  │  │ 取消 │  │   确定    │   │  │
│  │  └──────┘  └──────────┘   │  │
│  └────────────────────────────┘  │
└──────────────────────────────────┘
```

### 保存反馈 Toast

```
┌──────────────────────────────────┐
│                                  │
│        ┌──────────────┐          │
│        │ ✓ 设置已保存  │          │
│        └──────────────┘          │
│                                  │
└──────────────────────────────────┘
```

## 元素说明

| 序号 | 元素名称 | 类型 | 说明 |
|------|---------|------|------|
| 1 | 导航栏 | 顶部导航 | 左侧返回箭头 + 标题"学习设置"，无右侧按钮（自动保存无需手动保存） |
| 2 | 设置对象选择器 | 横向标签组 | 可选具体学生或"全部"，胶囊样式，选中高亮主题色，用于指定设置生效范围 |
| 3 | 分组标题 | 文本 | "学习时间"/"语音与互动"/"护眼与健康"，12pt 灰色，带水平分割线 |
| 4 | 学习提醒时间 | 列表 + 添加按钮 | 展示已设提醒时间列表，每项显示时间和编辑入口，最多 5 个提醒 |
| 5 | 提醒时间项 | 行内组件 | 显示时间（如 16:00），右侧「编辑」文字按钮，点击弹出时间选择器 |
| 6 | 添加提醒按钮 | 文字按钮 | 蓝色"+ 添加提醒"文字，点击弹出时间选择器新建提醒 |
| 7 | 学习时长滑块 | Slider 滑块 | 范围 15-90 分钟，步长 5 分钟，轨道两端显示最小/最大值，下方显示当前值 |
| 8 | 休息间隔滑块 | Slider 滑块 | 范围 10-45 分钟，步长 5 分钟，下方显示当前值和休息规则说明 |
| 9 | 语速滑块 | Slider 滑块 | 范围 0.75x-1.5x，步长 0.25x，刻度点标注，下方显示当前倍速和试听按钮 |
| 10 | 试听按钮 | 图标按钮 | 蓝色播放三角图标 + "试听"文字，点击播放对应语速/音色的示例语音 |
| 11 | 音色选择列表 | 单选列表 | 四种音色选项，每项含单选圆点、音色名称、试听按钮 |
| 12 | 护眼模式开关 | Toggle 开关 | iOS 风格开关，开启绿色/关闭灰色，下方附说明文字 |
| 13 | 定时护眼提醒开关 | Toggle 开关 | 同上样式，控制是否定时提醒远眺 |
| 14 | 时间选择器 | 底部弹层 | 滚轮式时间选取器（时:分），下方含星期重复选择 |
| 15 | 保存 Toast | 轻提示 | 页面顶部居中浮现，包含勾选图标和"设置已保存"文字 |

## 交互行为

### 手势交互
- **页面滚动**：页面整体可上下滚动，导航栏固定在顶部
- **滑块拖动**：手指在滑块轨道上左右拖动调整数值，松手后生效并自动保存
- **返回手势**：从屏幕左边缘右滑返回 F1
- **弹层关闭**：时间选择弹层区域外点击或下拉关闭

### 输入交互
- **选择设置对象**：点击顶部标签切换设置对象（张小明/张小红/全部），切换后下方设置项刷新为对应值
- **调整滑块**：拖动滑块调整数值，松手后自动保存，显示 toast 提示"设置已保存"
- **编辑提醒时间**：点击已有提醒的「编辑」按钮弹出时间选择器，左滑提醒项可删除
- **添加提醒**：点击「添加提醒」弹出时间选择器，选择时间和重复日期后确认添加
- **试听语速**：点击语速区域的「试听」按钮，以当前选择的语速播放示例语音"同学你好，我是小花老师"
- **选择音色**：点击音色选项进行单选，选中后自动保存
- **试听音色**：点击音色右侧「试听」按钮，播放对应音色的示例语音
- **切换开关**：点击护眼模式/定时护眼提醒开关，立即生效并自动保存

### 动画与反馈
- **滑块数值变化**：拖动时当前数值标签跟随滑块位置实时更新，数字平滑过渡
- **自动保存 Toast**：每次设置变更后，顶部弹出"设置已保存"Toast，1.5 秒后自动消失（从上滑入 + 淡出）
- **开关切换**：Toggle 开关切换时有滑动动画（200ms）和颜色过渡
- **护眼模式即时预览**：开启护眼模式时，屏幕色温平滑过渡到暖色调（500ms），关闭时恢复
- **试听播放**：点击试听时按钮变为暂停状态，播放完成自动恢复；播放期间有声波动画效果
- **设置对象切换**：切换标签时，下方设置区域执行淡入淡出切换（200ms）
- **时间选择器**：滚轮惯性滚动 + 吸附到最近刻度
- **触觉反馈**：滑块到达刻度点时轻微震动（Light Haptic）

### AI 老师交互
- 本页面不显示 AI 老师
- 音色选择和语速调整会影响全局 AI 老师的语音表现

## 状态枚举

### 默认状态
- 所有设置项显示当前已保存的值
- 滑块位于对应位置
- 开关反映当前开启/关闭状态
- 音色列表中当前选择项显示选中圆点

### 空状态
- 无提醒时间时：提醒列表区域显示"暂无学习提醒，添加提醒帮助孩子养成学习习惯"引导文案
- 其余设置项均有默认值，不存在空状态

### 加载状态
- 进入页面时，所有设置项区域显示骨架屏（200ms 内加载完成不显示骨架屏，避免闪烁）
- 试听音频加载中时，试听按钮显示 loading 小圈旋转

### 错误状态
- **保存失败**：Toast 显示"保存失败，请重试"（红色警示色），设置值回退到变更前状态
- **试听加载失败**：Toast 提示"音频加载失败，请检查网络"
- **网络断开**：页面正常显示已缓存设置，修改时 Toast 提示"当前离线，设置将在联网后同步"

### 边界情况
- **提醒上限**：最多 5 个提醒，达到上限后「添加提醒」按钮置灰并显示"最多设置5个提醒"
- **提醒时间冲突**：新增的提醒时间与已有提醒相同时，Toast 提示"该时间已存在提醒"
- **多端同步**：同一家庭多设备登录时，设置以最后修改为准，切回页面时静默刷新
- **试听音频冲突**：点击新的试听按钮时，自动停止上一个正在播放的试听
- **滑块极值**：滑块拖动到最小/最大值时有弹性回弹效果（防止超出范围）
- **学习时长与休息间隔冲突**：若学习时长上限小于休息间隔，自动将休息间隔调整为不超过学习时长，并 Toast 提示"休息间隔已自动调整"
- **设置对象为"全部"**：修改后覆盖所有学生的对应设置，弹出确认提示"将为所有学生应用此设置，确定？"

## 导航关系

### 从哪来
| 来源页面 | 触发方式 | 转场动画 |
|---------|---------|---------|
| F1 个人中心 | 点击「学习设置」菜单项（家长模式） | 右滑推入（push） |

### 到哪去
| 目标页面 | 触发方式 | 转场动画 |
|---------|---------|---------|
| F1 个人中心 | 左上角返回 / 左边缘右滑 | 左滑退出（pop） |
