# E2 周报

## 页面信息
- **所属模块**：E 学习报告模块
- **页面类型**：全屏页（左上角返回首页，无底部Tab导航；含子Tab：每日/周报/月报）
- **数字人老师**：不显示
- **支持模式**：通用（学生模式与家长模式均可查看，家长模式额外显示排名与对比信息）
- **路由**：`/report/weekly`

## 线框图

```
┌──────────────────────────────────┐
│ ← 学习报告                      │
├──────────────────────────────────┤
│   每日   [周报]   月报           │
│          ─────                   │
├──────────────────────────────────┤
│   ◀  第8周 (2/16 - 2/22)  ▶    │
├──────────────────────────────────┤
│  本周概览                        │
│ ┌────────────────────────────┐  │
│ │ 总时长      总题数    平均  │  │
│ │ 5h 20min   186题   正确率  │  │
│ │                      84%   │  │
│ │                            │  │
│ │ 上周: 4h 50min  ▲ +10%    │  │
│ └────────────────────────────┘  │
├──────────────────────────────────┤
│  每日学习时长                     │
│  min                             │
│  60│      ██                     │
│  50│  ██  ██  ██                 │
│  40│  ██  ██  ██  ██     ██     │
│  30│  ██  ██  ██  ██  ██ ██     │
│  20│  ██  ██  ██  ██  ██ ██ ██  │
│  10│  ██  ██  ██  ██  ██ ██ ██  │
│    └──┬───┬───┬───┬───┬──┬──┬── │
│      一  二  三  四  五 六 日    │
├──────────────────────────────────┤
│  正确率趋势                      │
│  %                               │
│ 100│                             │
│  90│  ·───·       ·───·         │
│  80│       ╲     ╱     ╲  ·    │
│  70│        ·───·        ╲╱     │
│  60│                      ·     │
│    └──┬───┬───┬───┬───┬──┬──┬── │
│      一  二  三  四  五 六 日    │
│                                  │
│    ── 本周  ·· 上周              │
├──────────────────────────────────┤
│  薄弱知识点 Top 5                │
│ ┌────────────────────────────┐  │
│ │ 1. 二次函数求极值     掌握  │  │
│ │    正确率 45%  错5题  [38%]│  │
│ │                      ▶练习 │  │
│ ├────────────────────────────┤  │
│ │ 2. 文言文虚词辨析     掌握  │  │
│ │    正确率 50%  错4题  [52%]│  │
│ │                      ▶练习 │  │
│ ├────────────────────────────┤  │
│ │ 3. 定语从句关系词     掌握  │  │
│ │    正确率 55%  错3题  [58%]│  │
│ │                      ▶练习 │  │
│ ├────────────────────────────┤  │
│ │ 4. 牛顿第二定律应用   掌握  │  │
│ │    正确率 58%  错3题  [60%]│  │
│ │                      ▶练习 │  │
│ ├────────────────────────────┤  │
│ │ 5. 化学方程式配平     掌握  │  │
│ │    正确率 60%  错2题  [65%]│  │
│ │                      ▶练习 │  │
│ └────────────────────────────┘  │
├──────────────────────────────────┤
│  与上周对比                      │
│ ┌────────────────────────────┐  │
│ │ 学习时长   5h20m  ▲ +30m  │  │
│ │ 答题总数   186题  ▲ +22题 │  │
│ │ 平均正确率 84%    ▲ +3%   │  │
│ │ 活跃天数   7天    ▲ +1天  │  │
│ │ 薄弱知识点 5个    ▼ -2个  │  │
│ └────────────────────────────┘  │
├──────────────────────────────────┤
│  ┌────────────────────────────┐  │
│  │ 🤖 小花老师本周总结        │  │
│  │                            │  │
│  │ "这一周你的学习非常稳定！  │  │
│  │  数学方面进步明显，二次函   │  │
│  │  数的正确率从上周32%提升   │  │
│  │  到了45%，继续加油！       │  │
│  │                            │  │
│  │  建议下周重点关注：        │  │
│  │  1. 二次函数求极值         │  │
│  │  2. 文言文虚词辨析..."     │  │
│  │                            │  │
│  │         [展开全部 ▼]       │  │
│  └────────────────────────────┘  │
│                                  │
└──────────────────────────────────┘
```

## 元素说明

### 顶部导航栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 返回按钮 | 图标按钮 | 左上角←箭头，点击返回B1首页 |
| 页面标题 | 文本 | "学习报告"，居中显示 |

### 子Tab栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 每日 | Tab项 | 切换至E1每日报告页 |
| 周报 | Tab项 | 当前选中，底部带高亮下划线指示器 |
| 月报 | Tab项 | 切换至E3月报页 |

### 周选择器
| 元素 | 类型 | 说明 |
|------|------|------|
| 左箭头 | 图标按钮 | 切换至前一周 |
| 右箭头 | 图标按钮 | 当前周时置灰不可点 |
| 周标题 | 文本 | 格式"第X周 (M/D - M/D)"，显示周一至周日的日期范围 |

### 本周概览卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 总学习时长 | 数据项 | 格式"Xh XXmin"，累计本周所有学习时长 |
| 总答题数 | 数据项 | 格式"XX题"，累计本周所有答题数 |
| 平均正确率 | 数据项 | 格式"XX%"，本周所有题目的平均正确率 |
| 上周对比 | 辅助文本 | 显示上周同指标数值及变化百分比，增长绿色▲，下降红色▼ |

### 每日学习时长柱状图
| 元素 | 类型 | 说明 |
|------|------|------|
| 柱状图 | 图表组件 | X轴为周一至周日，Y轴为学习时长（分钟） |
| 柱体 | 矩形 | 蓝色填充，圆角顶部，宽度固定 |
| 柱体标签 | 悬浮文本 | 点击柱体后在顶部显示具体数值"XX min" |
| Y轴刻度 | 文本 | 自动计算合适刻度，单位"min" |
| 今日标记 | 底部圆点 | 今天对应的柱体底部显示蓝色实心圆点 |

### 正确率趋势折线图
| 元素 | 类型 | 说明 |
|------|------|------|
| 本周折线 | 实线 | 蓝色实线，节点为实心圆点，连接本周每天的正确率 |
| 上周折线 | 虚线 | 灰色虚线，节点为空心圆点，连接上周每天的正确率作为对比 |
| 图例 | 标签 | 图表底部，区分"本周"实线与"上周"虚线 |
| 节点标签 | 悬浮文本 | 点击节点后显示具体数值"XX%" |
| 趋势区域 | 填充区域 | 本周折线下方填充半透明蓝色区域 |

### 薄弱知识点 Top 5
| 元素 | 类型 | 说明 |
|------|------|------|
| 序号 | 文本 | 1-5的排序编号 |
| 知识点名称 | 文本（可点击） | 点击跳转至D4知识点详情页 |
| 正确率 | 数据标签 | 显示该知识点本周正确率 |
| 错题数 | 数据标签 | 显示本周该知识点错误题数 |
| 掌握度进度条 | 进度条 | 百分比显示，颜色根据掌握程度变化（红/橙/绿） |
| 练习按钮 | 文字按钮 | "▶练习"，点击跳转至D1针对性练习 |

### 与上周对比卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 对比项 | 列表行 | 每行显示指标名称、本周数值、变化标记 |
| 增长标记 | 图标+文本 | 绿色▲箭头 + 增长数值，表示本周优于上周 |
| 下降标记 | 图标+文本 | 红色▼箭头 + 下降数值，表示本周不如上周 |
| 持平标记 | 文本 | 灰色"持平"，无变化时显示 |

### AI老师周总结卡片
| 元素 | 类型 | 说明 |
|------|------|------|
| 卡片容器 | 圆角卡片 | 浅蓝色渐变背景，带小花老师装饰头像 |
| 总结标题 | 文本 | "小花老师本周总结" |
| 总结内容 | 富文本 | 包含整体评价、进步肯定、薄弱分析与下周建议，默认显示前5行 |
| 展开按钮 | 可点击文本 | "展开全部 ▼"/"收起 ▲" |

## 交互行为

### 手势交互
| 手势 | 作用区域 | 行为 |
|------|----------|------|
| 左右滑动 | 周选择器区域 | 切换前一周/后一周的周报 |
| 左右滑动 | 子Tab栏下方整体内容区 | 切换每日/周报/月报子Tab |
| 上下滑动 | 页面主内容区 | 滚动浏览周报内容 |
| 点击柱体 | 每日学习时长柱状图 | 显示该天具体学习时长数值，同时高亮该柱体 |
| 双击柱体 | 每日学习时长柱状图 | 跳转至E1该天的每日报告 |
| 点击折线节点 | 正确率趋势图 | 显示该天具体正确率数值 |
| 点击知识点名称 | 薄弱知识点列表 | 跳转至D4知识点详情页 |
| 点击练习按钮 | 薄弱知识点列表 | 跳转至D1针对性练习 |
| 点击返回按钮 | 导航栏 | 返回B1首页 |

### 输入交互
| 输入方式 | 说明 |
|----------|------|
| 周选择器点击 | 点击周标题文本弹出周历选择器，可快速跳转到指定周 |

### 动画与反馈
| 动画 | 触发条件 | 效果说明 |
|------|----------|----------|
| 概览数据加载 | 页面加载/切换周时 | 数值从0递增至实际值，时长400ms |
| 柱状图绘制 | 数据加载完成 | 柱体从底部向上生长，从左到右依次延迟50ms，每根柱体动画时长300ms |
| 折线图绘制 | 数据加载完成 | 折线从左到右逐段绘制，时长600ms |
| 对比箭头动画 | 数据加载完成 | ▲▼箭头从中间位置弹出至最终位置，增长箭头上弹，下降箭头下弹，时长200ms |
| 知识点进度条 | 列表项出现在视口 | 进度条从0%填充至实际百分比，时长300ms |
| 周切换过渡 | 左右滑动切换周 | 内容区域随滑动方向平移过渡，时长200ms |
| 柱体高亮 | 点击柱体 | 选中柱体颜色加深，顶部浮现数值标签，其余柱体降透明度，时长150ms |

### AI老师交互
- 本页面不显示数字人老师悬浮头像，AI 交互通过底部"小花老师本周总结"卡片实现

## 状态枚举

### 默认状态
- 显示当前周（本周）的完整周报
- 右箭头置灰不可点（不可查看未来的周）
- 柱状图显示本周7天数据，折线图叠加本周与上周对比
- 薄弱知识点按正确率从低到高排序
- AI周总结默认折叠显示前5行

### 空状态
- **本周无任何学习记录**
  - 概览卡片显示"0h 0min / 0题 / --"
  - 柱状图显示空的坐标轴，无柱体
  - 折线图仅显示上周对比虚线（如有）
  - 薄弱知识点区域显示"本周暂无练习数据"
  - AI总结替换为鼓励文案"新的一周刚开始，让我们制定学习计划吧！"
  - 显示快捷按钮"制定学习计划"，跳转至C1

### 加载状态
- 周选择器正常显示
- 概览卡片显示骨架屏
- 柱状图区域显示灰色矩形骨架
- 折线图区域显示波浪线骨架
- 薄弱知识点显示5行列表骨架屏
- 对比卡片显示矩形骨架屏

### 错误状态
- **网络异常**：页面中部显示断网插画 + "网络开小差了" + "重新加载"按钮
- **服务端错误**：页面中部显示错误插画 + "数据获取失败" + "重新加载"按钮
- **图表渲染失败**：对应图表区域显示"图表加载失败，点击重试"，其余正常内容不受影响

### 边界情况
| 场景 | 处理方式 |
|------|----------|
| 注册不满一周 | 仅显示已有天数的数据，柱状图中未注册天数柱体不显示 |
| 本周只有1天有数据 | 柱状图正常显示1根柱体，折线图仅显示一个点（无连线） |
| 上周无数据（无法对比） | 折线图不显示上周虚线，对比卡片显示"上周暂无数据，无法对比" |
| 薄弱知识点不足5个 | 按实际数量显示，如仅有2个则显示Top 2 |
| 薄弱知识点为0 | 显示"本周没有明显薄弱知识点，继续保持！"，附带鼓励图标 |
| 某天学习时长超过4小时 | 柱状图Y轴自动调整刻度适配，该柱体顶部显示警告图标提示注意用眼 |
| 家长模式 vs 学生模式 | 家长模式在对比卡片中额外显示"班级平均"参考线与排名百分位 |
| 周报尚在生成中（周日晚上） | 显示"本周报告生成中..."，已有天数数据实时显示，AI总结区域显示"周报将在周一生成完整总结" |

## 导航关系

### 从哪来
| 来源页面 | 触发方式 | 传入参数 |
|----------|----------|----------|
| E1 每日报告 | 点击子Tab"周报" | week_of（当前查看日期所在周） |
| E3 月报 | 点击子Tab"周报" | 无（默认显示当前周） |
| B1 首页 | 点击功能气泡"学习报告"后切换子Tab | 无 |
| 推送通知 | 点击"本周学习周报已生成"推送 | week_of（指定周） |

### 到哪去
| 目标页面 | 触发方式 | 传出参数 |
|----------|----------|----------|
| B1 首页 | 点击左上角返回按钮← | 无 |
| E1 每日报告 | 双击柱状图某天的柱体 / 点击子Tab"每日" | date（指定日期） |
| E3 月报 | 点击子Tab"月报" | month_of（当前查看周所在月） |
| D4 知识点详情 | 点击薄弱知识点列表中的知识点名称 | knowledge_point_id |
| D1 知识点练习 | 点击薄弱知识点列表中的"▶练习"按钮 | knowledge_point_id, source="weekly_report" |
| C1 学习计划 | 空状态下点击"制定学习计划"按钮 | 无 |
