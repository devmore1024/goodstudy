# C2 学习计划总览

## 页面信息
- **所属模块**：C - 学习计划模块
- **页面类型**：全屏页（无底部Tab导航）
- **数字人老师**：小/右上角悬浮
- **支持模式**：通用（学生模式与家长模式视图有差异）
- **路由**：`/plan/overview`

## 线框图

```
┌──────────────────────────────────┐
│ ←  学习计划        ⚙️  [AI老师] │
├──────────────────────────────────┤
│                                  │
│  ┌──────────────────────────┐    │
│  │   < 2026年2月第3周 >      │    │
│  │     2.16 - 2.22           │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │ 本周概览                  │    │
│  │ 已完成 12/20 任务  完成60%│    │
│  │ ━━━━━━━━━━━━●━━━━━━━━    │    │
│  │ 数学6h  英语4h  语文3h    │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │ 周 一 二 三 四 五 六 日   │    │
│  ├──────────────────────────┤    │
│  │      ┃今天                │    │
│  │ 08 ──┃─────────────────── │    │
│  │ 09 ──┃─────────────────── │    │
│  │ 10 ▐█┃██▌   ▐████▌       │    │
│  │    │数┃学│   │数学│       │    │
│  │ 11 ▐█┃██▌   ▐████▌       │    │
│  │ 12 ──┃─────────────────── │    │
│  │ .. ──┃─────────────────── │    │
│  │ 16   ┃▐████▌   ▐████▌    │    │
│  │      ┃│英语│   │英语│    │    │
│  │ 17   ┃▐████▌   ▐████▌    │    │
│  │ 18 ▐█┃██▌▐████▌          │    │
│  │    │语┃文││物理│          │    │
│  │ 19 ▐█┃██▌▐████▌   ▐████▌ │    │
│  │      ┃         │周测│    │    │
│  │ 20 ──┃────────▐████▌──── │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │ 图例:                     │    │
│  │ 🟦数学 🟩英语 🟨语文      │    │
│  │ 🟪物理 🟥测评 ⚠️冲突      │    │
│  └──────────────────────────┘    │
│                                  │
│  ┌──────────────────────────┐    │
│  │  + 添加学习时段           │    │
│  └──────────────────────────┘    │
│                                  │
└──────────────────────────────────┘
```

### 冲突状态线框

```
┌──────────────────────────────────┐
│  ⚠️ 发现时间冲突                 │
│  ┌──────────────────────────┐    │
│  │ 周三 16:00-17:00          │    │
│  │ ▐███████████████▌         │    │
│  │ │ 英语(计划) ⚠️ │         │    │
│  │ │ 钢琴课(线下) │         │    │
│  │ ▐███████████████▌         │    │
│  │                           │    │
│  │ [调整计划]  [忽略冲突]    │    │
│  └──────────────────────────┘    │
└──────────────────────────────────┘
```

## 元素说明

| 序号 | 元素名称 | 类型 | 说明 |
|------|---------|------|------|
| 1 | 导航栏 | 固定顶栏 | 左侧返回按钮+标题"学习计划"。右侧设置图标和AI老师悬浮头像 |
| 2 | 周切换器 | 横向选择器 | 显示当前周的年/月/周数和日期范围，左右箭头切换周，支持左右滑动手势切换 |
| 3 | 本周概览卡片 | 统计卡片 | 显示本周任务完成进度（已完成/总数）、完成百分比进度条、各科目分配时长标签 |
| 4 | 周视图时间表 | 可交互日历网格 | 横轴为周一至周日，纵轴为时间轴（8:00-21:00），不同科目用不同颜色的色块表示，今日列有竖线高亮标识 |
| 5 | 时间色块 | 可交互色块 | 每个学习时段为一个色块，显示科目名称，已完成的色块有勾选标记，冲突色块有警告图标和斜线纹理 |
| 6 | 颜色图例 | 静态说明 | 底部显示各科目对应颜色、测评标识、冲突标识的说明 |
| 7 | 添加时段按钮 | 文字按钮 | 点击后弹出时段添加浮层，可选择日期、时间、科目 |
| 8 | AI老师悬浮头像 | 悬浮组件 | 右上角小尺寸AI老师头像，有呼吸动画，点击可展开对话 |

## 交互行为

### 手势交互
- **左右滑动切换周**：在周视图区域左右滑动可切换上一周/下一周，带平滑过渡动画，周切换器同步更新
- **长按色块拖拽**：长按某个学习时段色块，进入编辑模式，色块浮起带阴影，可拖拽到其他时间位置，松手后色块落入新位置并有弹性动画
- **点击色块查看详情**：单击色块弹出底部浮层显示该时段详情（科目、时间、学习内容、完成状态）
- **双指缩放**：支持双指缩放调整时间轴精度（30分钟/1小时/2小时刻度）
- **下拉刷新**：下拉可刷新计划数据同步最新完成状态

### 输入交互
- **添加时段**：点击"添加学习时段"按钮，弹出底部浮层选择：日期（周几）、开始时间、结束时间、科目，确认后色块出现在对应位置
- **冲突处理**：点击冲突色块后显示冲突详情，提供"调整计划"（跳转编辑）和"忽略冲突"两个操作
- **设置入口**：点击右上角设置图标，可进入计划设置（修改科目、时长、测评频率等）

### 动画与反馈
- **周切换动画**：切换周时整个时间表向左/右滑出，新一周从反方向滑入，耗时300ms
- **色块拖拽动画**：拖拽中色块放大1.1倍并有投影效果，目标位置显示虚线占位框
- **进度条动画**：进入页面时进度条从0%动画增长到当前值，耗时600ms
- **完成标记动画**：任务完成时色块上出现勾选标记，伴随缩放弹跳效果
- **冲突闪烁**：存在冲突的色块边框以红色脉冲闪烁，每3秒一次
- **今日标识**：今日列的竖线有微弱的发光脉冲效果

### AI 老师交互
- **点击AI头像展开对话**：点击右上角AI头像，弹出底部对话浮层，可语音或文字与AI老师沟通调整计划
- **主动提醒**：AI老师在检测到以下情况时主动弹出对话气泡：①连续3天未完成计划 ②本周完成率低于40% ③存在时间冲突
- **智能建议**：AI老师根据完成情况给出调整建议，如"这周数学完成得不错，下周可以适当增加难度哦"

## 状态枚举

### 默认状态
- 显示当前周的完整时间表
- 本周概览卡片显示实时完成进度
- 今日列高亮标识
- 各科目色块正常显示

### 空状态
- 时间表区域为空白网格
- 中央显示空状态插图（AI老师捧着日历的可爱插画）
- 提示文案："还没有学习计划呢，让我来帮你创建一个吧！"
- 显示"创建学习计划"主按钮，点击跳转C1

### 加载状态
- 周切换器正常显示
- 时间表区域显示骨架屏（灰色占位色块闪烁）
- 本周概览卡片数字显示"--"
- AI老师头像显示加载旋转动画

### 错误状态
- 时间表区域显示错误插图
- 提示文案："加载失败了，点击重试"
- 显示"重试"按钮
- 若为网络错误，显示本地缓存的上次数据并标注"数据可能不是最新的"

### 边界情况
- **历史周查看**：查看过去的周次时，色块显示最终完成状态（已完成/未完成），不可编辑拖拽
- **未来周查看**：查看未来的周次时，所有色块为计划状态，可编辑
- **多个冲突**：同时存在多个冲突时，顶部显示红色横幅"有N个时间冲突需要处理"，可点击逐个查看
- **家长模式差异**：家长模式下额外显示孩子的完成状态统计、可锁定/解锁计划修改权限
- **学生模式差异**：学生模式下若计划被家长锁定，色块不可拖拽，显示"计划已被家长锁定"提示

## 导航关系

### 从哪来
- **B1 学生首页**：通过语音指令或AI引导进入
- **B2 家长首页**：点击功能气泡"学习计划"
- **C1 学习计划创建**：创建计划完成后跳转至此，自动定位到当前周

### 到哪去
- **C2a 每日计划详情**：点击某一天的列区域或某个色块，跳转到该日的详细时间线视图
- **C3 测评设置**：点击测评类型的色块，或从设置中进入测评配置
- **C1 学习计划创建**：空状态下点击"创建学习计划"，或设置中点击"重新创建计划"
