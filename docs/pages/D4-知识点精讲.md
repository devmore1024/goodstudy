# D4 知识点精讲

## 页面信息
- **所属模块**：D-核心学习模块
- **页面类型**：全屏页（三段式内容：概念 → 例题 → 练习，可横向切换）
- **数字人老师**：小/右上角悬浮（授课状态，语音讲解）
- **支持模式**：学生

## 线框图

### 概念讲解区

```
┌──────────────────────────────────┐
│ ← 分数加减法           ┌────┐  │
│   数学 · 五年级上       │ 🌸 │  │
│                         │老师│  │
│ ┌────┐  ┌────┐  ┌────┐ └────┘  │
│ │概念│  │例题│  │练习│          │
│ └────┘  └────┘  └────┘          │
│  ━━━━                           │
├──────────────────────────────────┤
│                                  │
│  📘 什么是分数加减法？          │
│  ──────────────────────────────  │
│                                  │
│  分数加减法是指对两个或多个      │
│  分数进行加法或减法运算。       │
│                                  │
│  🔑 核心要点：                  │
│  ┌──────────────────────────┐   │
│  │ 1. 同分母分数直接加减    │   │
│  │    分子，分母不变        │   │
│  │                          │   │
│  │ 2. 异分母分数需先通分    │   │
│  │    再进行加减            │   │
│  │                          │   │
│  │ 3. 结果要化为最简分数    │   │
│  └──────────────────────────┘   │
│                                  │
│  📐 公式：                      │
│  ┌──────────────────────────┐   │
│  │  a/c + b/c = (a+b)/c    │   │
│  │  a/b + c/d              │   │
│  │  = ad/bd + bc/bd        │   │
│  │  = (ad+bc)/bd           │   │
│  └──────────────────────────┘   │
│                                  │
├──────────────────────────────────┤
│  ▶ ━━━━━━━━━━━━━○─── 3:24/5:10 │
│                    1x  1.5x  2x │
└──────────────────────────────────┘
```

### 例题区

```
┌──────────────────────────────────┐
│ ← 分数加减法           ┌────┐  │
│   数学 · 五年级上       │ 🌸 │  │
│                         │老师│  │
│ ┌────┐  ┌────┐  ┌────┐ └────┘  │
│ │概念│  │例题│  │练习│          │
│ └────┘  └────┘  └────┘          │
│          ━━━━                    │
├──────────────────────────────────┤
│                                  │
│  📝 例题 1/3                    │
│  ──────────────────────────────  │
│                                  │
│  计算：2/3 + 1/4 = ?            │
│                                  │
│  📖 解题过程：                  │
│  ┌──────────────────────────┐   │
│  │ 步骤①：找最小公倍数     │   │
│  │   3和4的最小公倍数是12   │   │
│  │                          │   │
│  │ 步骤②：通分              │   │
│  │   2/3 = 8/12             │   │
│  │   1/4 = 3/12             │   │
│  │                          │   │
│  │ 步骤③：相加              │   │
│  │   8/12 + 3/12 = 11/12   │   │
│  │                          │   │
│  │ ✅ 答案：11/12           │   │
│  └──────────────────────────┘   │
│                                  │
│   ← 上一题    ●○○    下一题 →  │
│                                  │
├──────────────────────────────────┤
│  ▶ ━━━━━━━━━━━━━━━━○─ 4:30/5:10 │
│                    1x  1.5x  2x │
└──────────────────────────────────┘
```

### 练习区

```
┌──────────────────────────────────┐
│ ← 分数加减法           ┌────┐  │
│   数学 · 五年级上       │ 🌸 │  │
│                         │老师│  │
│ ┌────┐  ┌────┐  ┌────┐ └────┘  │
│ │概念│  │例题│  │练习│          │
│ └────┘  └────┘  └────┘          │
│                    ━━━━          │
├──────────────────────────────────┤
│                                  │
│  ✏️ 练一练 (1/3)                │
│  ──────────────────────────────  │
│                                  │
│  计算：1/2 + 2/5 = ?            │
│                                  │
│  ┌──────────────────────────┐   │
│  │                          │   │
│  │  你的答案：[         ]   │   │
│  │                          │   │
│  └──────────────────────────┘   │
│                                  │
│  ┌──────────────────────────┐   │
│  │         提交答案         │   │
│  └──────────────────────────┘   │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
│                                  │
├──────────────────────────────────┤
│  ▶ ━━━━━━━━━━━━━━━━━━━━ 5:10    │
│                    1x  1.5x  2x │
└──────────────────────────────────┘
```

### 练习结果反馈

```
┌──────────────────────────────────┐
│                                  │
│  ✏️ 练一练 (1/3)                │
│  ──────────────────────────────  │
│                                  │
│  计算：1/2 + 2/5 = ?            │
│                                  │
│  ┌──────────────────────────┐   │
│  │  你的答案：9/10          │   │
│  │  ✅ 回答正确！           │   │
│  └──────────────────────────┘   │
│                                  │
│  ┌──────────────────────────┐   │
│  │ 解题过程：               │   │
│  │ 1/2 + 2/5               │   │
│  │ = 5/10 + 4/10           │   │
│  │ = 9/10  ✓               │   │
│  └──────────────────────────┘   │
│                                  │
│  ┌──────────────────────────┐   │
│  │         下一题 →         │   │
│  └──────────────────────────┘   │
│                                  │
└──────────────────────────────────┘
```

### 学习完成状态

```
┌──────────────────────────────────┐
│ ← 分数加减法                    │
├──────────────────────────────────┤
│                                  │
│         🎉 学习完成！           │
│                                  │
│    本次练习：3/3 全对            │
│    学习时长：5分10秒             │
│                                  │
│  ┌──────────────────────────┐   │
│  │  你觉得这个知识点：      │   │
│  │                          │   │
│  │  ┌──────────────────┐   │   │
│  │  │    ✅ 已掌握      │   │   │
│  │  └──────────────────┘   │   │
│  │  ┌──────────────────┐   │   │
│  │  │    📝 需复习      │   │   │
│  │  └──────────────────┘   │   │
│  │                          │   │
│  └──────────────────────────┘   │
│                                  │
│  ┌──────────────────────────┐   │
│  │    问小花老师   │  返回  │   │
│  └──────────────────────────┘   │
│                                  │
└──────────────────────────────────┘
```

## 元素说明

| 元素 | 类型 | 说明 |
|------|------|------|
| 导航栏 | 顶部栏 | 返回按钮 + 知识点名称 + 学科/年级标签 |
| 小花老师头像 | 悬浮视图 | 右上角48x48圆形头像，讲解时有嘴巴动画 |
| 内容Tab | 分段控件 | 概念/例题/练习三个Tab，支持点击和左右滑动切换 |
| 概念文本 | 富文本 | 支持文字、公式（LaTeX渲染）、重点标记（高亮背景） |
| 核心要点卡片 | 卡片组件 | 浅蓝色背景卡片，编号列表展示核心概念 |
| 公式卡片 | 卡片组件 | 浅灰色背景，LaTeX渲染的数学公式 |
| 例题步骤 | 折叠/展开 | 分步骤展示解题过程，可逐步展开 |
| 例题翻页指示器 | 分页控件 | 圆点指示器 + 左右箭头，显示当前/总数 |
| 答案输入框 | 输入控件 | 支持数字、分数、小数输入，带分数键盘 |
| 提交按钮 | 主操作按钮 | 绿色背景按钮，提交答案进行判定 |
| 结果反馈 | 内联反馈 | 正确：绿色对勾 + "回答正确！"；错误：红色叉 + "再想想" |
| 音频播放栏 | 固定底栏 | 播放/暂停按钮 + 进度条 + 时间 + 倍速切换 |
| 倍速控制 | 分段按钮 | 1x / 1.5x / 2x 三档切换 |
| 掌握度选择 | 按钮组 | "已掌握" / "需复习" 两个选择按钮 |
| 完成统计 | 信息卡片 | 展示练习正确率、学习时长 |

## 交互行为

### 手势交互
- **左右滑动切换**：在概念/例题/练习三个区域间横向滑动切换
- **上下滚动**：每个区域内支持垂直滚动浏览内容
- **左右滑动例题**：例题区域内左右滑动切换不同例题
- **双击公式**：放大查看公式细节

### 输入交互
- **点击Tab切换**：点击概念/例题/练习Tab切换内容区域
- **点击播放/暂停**：控制音频讲解的播放状态
- **拖动进度条**：跳转到音频的指定位置
- **点击倍速按钮**：在1x/1.5x/2x间循环切换播放速度
- **输入答案**：练习区点击输入框弹出数字/分数键盘，输入答案
- **点击提交**：提交答案进行即时判定
- **选择掌握度**：学习完成后选择"已掌握"或"需复习"
- **点击"问小花老师"**：跳转D3实时答疑，携带当前知识点信息

### 动画与反馈
- **Tab切换动画**：内容区域横向滑动过渡，下划线跟随移动，300ms缓动
- **答案正确动画**：绿色对勾弹出 + 输入框边框变绿 + 轻微震动
- **答案错误动画**：红色叉号抖动 + 输入框边框变红 + 轻微震动
- **步骤逐步展示**：例题解题步骤逐步渐入，配合音频讲解节奏
- **完成撒花动画**：全部练习完成后顶部撒花粒子效果
- **音频播放指示**：小花老师头像在讲解时有嘴巴张合动画
- **进度条动画**：音频播放时进度条平滑前进

### AI 老师交互
- **进入概念区**：小花老师语音开始讲解概念，与文字内容同步
- **切换到例题**：小花老师语音"我们来看几个例题吧~"并逐步讲解
- **切换到练习**：小花老师语音"现在轮到你来试试了！"
- **答对鼓励**：小花老师语音"太棒了，完全正确！"（随机鼓励语）
- **答错引导**：小花老师语音"差一点点，再想想看~" 并给出提示但不直接说答案
- **选择"已掌握"**：小花老师语音"很好，继续保持！"
- **选择"需复习"**：小花老师语音"没关系，下次复习的时候我再陪你一起学~"
- **长时间未答题**：超过2分钟未输入答案，小花老师语音"需要提示吗？"

## 状态枚举

### 默认状态
- 默认进入概念区，自动播放音频讲解
- 小花老师悬浮头像显示讲解中动画
- 音频播放栏固定在底部

### 空状态
- 场景：知识点内容未加载完成或无内容
- 展示：骨架屏占位 + "内容准备中…"
- 该知识点无例题/练习时，对应Tab显示"暂无内容，敬请期待"

### 加载状态
- 首次进入：顶部Tab正常显示，内容区域显示骨架屏（文本行占位+卡片占位）
- 音频加载：播放栏显示加载旋转图标，进度条灰色不可交互
- 提交答案：提交按钮显示加载动画，2秒内返回结果

### 错误状态
- **内容加载失败**：显示错误插图 + "加载失败" + "重试"按钮
- **音频播放失败**：播放栏显示"音频加载失败，点击重试"
- **答案提交失败**：弹出Toast"提交失败，请重试"，答案保留不清空
- **网络异常**：顶部红色横幅"网络已断开"，已加载内容仍可浏览但无法提交

### 边界情况
- **无练习题**：知识点暂无配套练习题时，练习Tab显示"暂无练习题"并提供"问老师"入口
- **公式渲染失败**：LaTeX渲染失败时显示原始文本，标注"公式显示异常"
- **音频与文字不同步**：提供手动同步按钮，点击将文字滚动到当前音频位置
- **练习中途退出**：弹出确认弹窗"确定要退出吗？当前进度将保存"
- **重复学习**：已学过的知识点再次进入，显示上次学习记录和掌握度，支持重新学习

## 导航关系

### 从哪来
- **D1-每日学习主页**：点击类型为"知识点精讲"的任务卡片
- **D2-拍照判题**：点击错题解析中的"查看知识点精讲"链接
- **D3-实时答疑**：点击对话中出现的知识点链接
- **D5-知识点列表**：点击列表中的某个知识点
- **C5-学习报告/推荐**：点击推荐的知识点学习

### 到哪去
- **D5-知识点列表**：完成学习后点击"返回"回到知识点列表
- **D3-实时答疑**：点击"问小花老师"按钮，携带知识点信息进入答疑
