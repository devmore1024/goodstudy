# B1 首页-学生模式

## 页面信息
- **所属模块**：首页模块（B）
- **页面类型**：全屏页（无底部Tab导航）
- **数字人老师**：大/居中，带待机呼吸动画循环
- **支持模式**：学生
- **路由**：`/home/student`

## 线框图

### 默认状态

```
┌──────────────────────────────────┐
│ 状态栏（系统）                    │
├──────────────────────────────────┤
│  早上好，小明同学！          [⚙] │
│  今天是周二，加油哦~              │
├──────────────────────────────────┤
│                                  │
│                                  │
│          ┌──────────┐            │
│          │          │            │
│          │  小花老师  │            │
│          │  (数字人)  │            │
│          │  待机动画  │            │
│          │          │            │
│          └──────────┘            │
│       "小花老师，你好"            │
│                                  │
├──────────────────────────────────┤
│  📖 今日学习计划 (3/5)           │
│  ──────────────────────────────  │
│                                  │
│  ☑ [数学] 分数加减法 · 知识点精讲│
│    已完成 · 掌握度 85%           │
│  ──────────────────────────────  │
│  ☑ [数学] 口算练习 · 每日一练    │
│    已完成 · 正确率 90%           │
│  ──────────────────────────────  │
│  ☐ [数学] 应用题专项 · 拍照判题  │
│    未开始                        │
│  ──────────────────────────────  │
│  ☐ [语文] 古诗词背诵 · 知识点精讲│
│    未开始                        │
│  ──────────────────────────────  │
│  ☐ [英语] 英语单词听写 · 听写练习│
│    未开始                        │
│  ──────────────────────────────  │
├──────────────────────────────────┤
│  ← 📖知识课堂  💬答疑  📷拍照  │
│     判题  📝测评  📊学习报告 →  │
│       （可左右滑动的气泡）        │
├──────────────────────────────────┤
│ 🎤 ┌────────────────┐  ➤  ⊕   │
│    │ 问小花老师...    │         │
│    └────────────────┘          │
└──────────────────────────────────┘
```

### 功能气泡详情

```
┌──────────────────────────────────┐
│                                  │
│  ┌──────────┐ ┌──────┐ ┌─────┐ │
│  │📖知识课堂│ │💬答疑│ │📷拍 │→│
│  └──────────┘ └──────┘ │照判题│ │
│                         └─────┘ │
│  ← 可左右滑动                →  │
│                                  │
│  完整列表：                      │
│  📖 知识课堂 → /knowledge       │
│  💬 答疑     → /qa              │
│  📷 拍照判题 → /photo-judge     │
│  📝 测评     → /test/setup      │
│  📊 学习报告 → /report          │
│                                  │
└──────────────────────────────────┘
```

## 元素说明

### 顶部问候区域
| 元素 | 类型 | 说明 |
|------|------|------|
| 问候语 | 文本 | 根据当前时段动态显示（早上好/下午好/晚上好），包含学生姓名，字号18sp，加粗 |
| 日期提示 | 文本 | 显示今天星期几及鼓励语，字号14sp，次要文字色 |
| 设置图标 | 图标按钮 | 右上角⚙齿轮图标，点击跳转到F1个人中心/设置页面 |

### 数字人老师区域
| 元素 | 类型 | 说明 |
|------|------|------|
| 小花老师形象 | 3D数字人渲染 | 居中展示，高度约占屏幕1/3，待机时播放呼吸动画（微微晃动、眨眼） |
| 语音唤醒提示 | 文本 | 数字人下方，提示"小花老师，你好"唤醒词，字号12sp，辅助色 |

### 今日学习计划区域
| 元素 | 类型 | 说明 |
|------|------|------|
| 学习计划标题 | 文本 | "今日学习计划 (已完成/总数)"，动态更新 |
| 任务卡片 | 列表项 | 包含：复选框、学科标签、任务名称、任务类型、完成状态/数据 |
| 学科标签 | 标签 | 方括号包裹的学科名称，如 [数学]、[语文]、[英语]，跟随学科色：数学蓝、语文红、英语绿 |
| 复选框 | 控件 | 已完成为绿色勾选 ☑，未完成为空心框 ☐ |
| 任务类型 | 文本标签 | "知识点精讲""每日一练""拍照判题""听写练习"等 |
| 完成数据 | 辅助文本 | 已完成显示掌握度/正确率，未完成显示"未开始" |

### 功能气泡区域
| 元素 | 类型 | 说明 |
|------|------|------|
| 气泡容器 | 水平滚动区域 | 位于输入栏上方，可左右滑动，无滚动条，内距16dp |
| 知识课堂 | 气泡按钮 | 圆角药丸形，📖图标+文字，浅绿色背景，第一个位置，跳转 `/knowledge` |
| 答疑 | 气泡按钮 | 圆角药丸形，💬图标+文字，浅蓝色背景，跳转 `/qa` |
| 拍照判题 | 气泡按钮 | 圆角药丸形，📷图标+文字，浅橙色背景，跳转 `/photo-judge` |
| 测评 | 气泡按钮 | 圆角药丸形，📝图标+文字，浅紫色背景，跳转 `/test/setup` |
| 学习报告 | 气泡按钮 | 圆角药丸形，📊图标+文字，浅黄色背景，跳转 `/report` |

### 底部输入栏
| 元素 | 类型 | 说明 |
|------|------|------|
| 输入栏 | 复合控件 | 固定底部，复用 ChatInputBar 组件，支持文字输入和语音切换 |
| 文本输入框 | 输入框 | 圆角，placeholder"问小花老师..."，回车发送 |
| 语音/键盘切换 | 图标按钮 | 左侧麦克风/键盘图标，切换输入模式 |
| 发送按钮 | 图标按钮 | 有内容时高亮为主题色 |

## 交互行为

### 手势交互
- **点击任务卡片**：跳转对应任务页面（知识点精讲→D4，拍照判题→D2 等）
- **任务列表滚动**：任务列表区域可上下滚动浏览
- **任务完成动画**：任务完成后复选框播放勾选动画
- **左右滑动气泡**：功能气泡区域支持水平滑动浏览所有入口，首屏显示前3个，滑动可见更多
- **下拉刷新**：页面下拉触发数据刷新，小花老师播放"刷新"动作动画
- **上滑浏览**：页面整体可上下滚动，数字人区域随页面滚动会缩小并吸附到顶部（过渡动画300ms）
- **点击气泡**：跳转到对应功能页面

### 输入交互
- **语音唤醒**：全局监听"小花老师"唤醒词（需用户授权麦克风权限），唤醒后数字人进入聆听状态，界面底部弹出语音输入浮层
- **按住说话**：语音模式下按住按钮录音，松开后发送语音指令给AI处理，支持语音识别为文字显示
- **文字输入**：在底部输入栏输入文字，点击发送或回车，小花老师进行AI回复
- **语音指令识别**：支持自然语言指令，如"开始今天的数学学习""帮我检查作业""我想复习英语单词"等
- **声纹验证**：首次语音唤醒时自动进行声纹比对，确认是注册的学生本人
- **点击设置图标**：跳转到F1个人中心/设置页面

### 动画与反馈
- **数字人待机动画**：循环播放呼吸动画（轻微上下浮动、眨眼、偶尔挥手），每30秒随机切换一个待机姿态
- **数字人交互动画**：语音交互时播放说话口型动画，完成任务时播放鼓掌动画，登录时播放挥手问好动画
- **气泡点击反馈**：点击气泡时有轻微缩放（scale 0.95）+ 弹回效果
- **页面进入动画**：首次进入时，数字人从屏幕下方弹入（500ms缓动），问候语淡入（300ms延迟），气泡从右侧依次滑入
- **语音波纹**：录音期间，按钮周围显示声波扩散动画，实时反映音量大小
- **触觉反馈**：点击气泡触发轻微震动（haptic feedback）

### AI 老师交互
- **进入页面问候**：小花老师根据时段自动语音问候。例如：
  - 早上首次打开："早上好呀小明！今天想学点什么呢？"
  - 下午打开："小明同学下午好！需要我帮你解题还是复习知识点呢？"
- **主动提醒**：如果学生长时间未操作（超过30秒），小花老师会语音提示"小明，要开始学习了吗？可以点下面的气泡开始哦~"
- **文字对话**：通过底部输入栏发送文字后，小花老师根据内容智能回复并引导到对应功能模块
- **成就鼓励**：学习完成后返回首页，小花老师随机播放鼓励语音，如"做得好！""你真是太棒了！""继续保持哦~"

## 状态枚举

### 默认状态
- 页面正常加载完成，显示学生姓名、问候语
- 数字人播放待机动画
- 功能气泡显示：知识课堂、答疑、拍照判题、测评、学习报告（共5个）
- 右上角显示设置图标

### 空状态
- **网络不可用但有缓存**：页面正常显示，功能气泡入口仍可点击（跳转后各页面自行处理离线状态）
- **未设置学习计划**：新用户首次进入，小花老师语音引导"你好呀！我是小花老师，有什么不会的题可以问我哦~"

### 加载状态
- **首次加载**：数字人区域显示加载骨架屏，气泡显示灰色占位
- **刷新加载**：下拉刷新时顶部显示圆形加载指示器，小花老师播放"思考中"动画（手托下巴）
- **语音处理中**：录音结束后，输入栏变为"识别中..."状态，显示三个跳动圆点动画

### 错误状态
- **网络错误**：顶部横幅提示"网络开小差了~"，功能气泡入口仍可点击
- **语音识别失败**：弹出轻提示Toast"没有听清楚，请再说一次"，小花老师播放疑惑动画（歪头），自动恢复到待机状态
- **声纹验证失败**：弹出弹窗提示"声音验证未通过，请让注册的同学来操作"，提供"切换账号"和"重试"按钮
- **数字人加载失败**：显示小花老师静态头像图片替代，底部文字提示"小花老师正在赶来的路上~"

### 边界情况
- **多端登录冲突**：弹窗提示"你的账号在另一台设备上登录了"，提供"继续使用"（踢掉另一端）和"退出登录"选项
- **学习时间限制**：家长设置的可用时段之外打开App时，显示锁定页"当前不在学习时间段内，请在XX:XX-XX:XX时间段使用"，数字人播放"睡觉"动画
- **深夜使用提醒**：22:00后打开，小花老师语音提示"已经很晚了，早点休息明天继续学习吧~"，页面增加护眼模式暖色滤镜
- **姓名过长**：问候语中学生姓名超过6个字时截断显示，末尾加"..."

## 导航关系

### 从哪来
| 来源页面 | 场景说明 |
|----------|----------|
| A1 启动页 | 老用户直接登录后进入，自动声纹识别为学生身份 |
| A3a 学生注册引导 | 新学生完成注册引导流程后首次进入 |
| A4 声纹采集 | 完成声纹采集后跳转回首页 |
| B2 家长首页 | 通过身份切换进入学生模式首页 |

### 到哪去
| 目标页面 | 触发条件 |
|----------|----------|
| D2 拍照判题 | 点击功能气泡"拍照判题"，或点击今日学习计划中"拍照判题"类型的任务 |
| D3 AI答疑 | 点击功能气泡"答疑"，或语音唤醒后提问 |
| D1 知识课堂 | 点击功能气泡"知识课堂" |
| D4 知识点精讲 | 点击今日学习计划中"知识点精讲"类型的任务 |
| C3 测评设置 | 点击功能气泡"测评" |
| E1 学习报告 | 点击功能气泡"学习报告" |
| F1 个人中心 | 点击右上角设置图标⚙ |
